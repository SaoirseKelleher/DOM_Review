---
title: "Twenty years of dynamic occupancy models: a review of applications and a look towards the future"
date: today

authors:
  - name: Saoirse Kelleher
    affiliation: University of Melbourne
    email: saoirse.kelleher@student.unimelb.edu.au
    orcid: 0000-0002-4614-5753
    corresponding: true
  - name: Natalie Briscoe
    affiliation: University of Melbourne
  - name: Gurutzeta Guillera-Arroita
    affiliation: Pyrenean Institute of Ecology, Spanish National Research Council
  - name: Jane Elith
    affiliation: University of Melbourne
    
abstract: | 
  Describing patterns of species occupancy across landscapes and throughout time is a fundamental aspect of much ecological research. The dynamic multi-season occupancy model is an important tool for analysing wildlife occurence data -- by explicitly estimating colonisation and extinction probabilities while accounting for imperfect detection, it strikes a favourable balance between realism and feasibility. These models can be used in similar ways to more conventional species distribution models, which can struggle to deal with imperfect detection and non-equilibrium populations.
  
  We present a review of applications of the dynamic occupancy model in the twenty years since its initial publication. Our findings indicate that this model demonstrates exceptional flexibility with suitability to address a wide range of ecological questions, and that it may have  broader potential than commonly thought. We also note that practices in fitting dynamic occupancy models are highly variable, and that the existing literature lacks clear answers for best practices. This contrasts strongly with the robust species distribution model literature on modelling practices, which we suggest may be a valuable resource for improving how authors implement dynamic occupancy models.

bibliography: references.bib
---

# Introduction

Ecologists have long sought to describe the processes by which species are distributed across landscapes and throughout time [@humboldt1849]. An understanding of where a species exists, which factors lead to its presence, and how its distribution may change has always been of interest and is ever more important in a dynamic and changing world. Descriptions of how widespread a species is and where it occurs are the foundation of monitoring programs and are imperative for assessing conservation status, and further untangling the drivers of occurrence can help us to better understand a species life history and inform potential management actions. A robust understanding of the occupancy patterns of a species also helps us to predict where a species is most likely to occur — now, and under hypothetical future scenarios.

The need to reliably describe species occupancy has led to the development of numerous quantitative approaches, of which the best known are species distribution models [SDMs, @elith2009]. The prototypical SDM correlates records of species occurrence with environmental features to determine where species are most probable to occur. While SDMs are an exceedingly popular tool for describing occupancy, they do have considerable downsides. First and foremost, SDMs do not typically account for imperfect detection, a near-ubiquitous characteristic of wildlife field data that can lead to meaningful bias in estimates of occupancy [@lahoz-monfort2014; @guillera-arroita2017; @gu2004]. Secondly, SDMs have been noted to perform poorly when a species' distribution is not at equilibrium [@elith2010]. This may be problematic when working with invasive species or species whose ranges are expanding or contracting, all of which are increasingly common scenarios in the Anthropocene [@bertelsmeier2013; @lenoir2015].

The dynamic occupancy model (DOMs, also termed 'multi-season occupancy models') introduced in @mackenzie2003 provide an alternative framework to modelling occurrence and distributions. By explicitly describing the colonisation and extinction processes which guide occupancy while accounting for imperfect detection, the model class offers more advanced insights than simpler static species distribution models; despite this, input data requirements remain achievable compared to other more complex process-explicit models. Dynamic occupancy models unite two processes: the ecological process of site occupancy describing the presence or absence of a species at a site at any point in time, and the observational process of detection describing whether a species is observed given that a site is occupied (@fig-modelform). Under this parameterisation, sites exist in either occupied or unoccupied states. The occupancy state for each step in the first time-step is given by the *initial occupancy* parameter, and in ensuing time-steps occupancy is determined based on probabilities of *colonisation* and *extinction.* Given that a site is occupied, the probability of observing the species during a survey is given by the *detection* parameter. In the DOM's standard form, it is assumed that false-positive detections do not occur.

![The original parameterisation of the dynamic occupancy model as described by @mackenzie2003. The occupancy state of any given site is described in the ecological process. In the first season, occupancy is determined by the *initial occupancy* parameter. In subsequent season, unoccupied sites may become occupied according to the colonisation probability and occupied sites may become unoccupied according to the extinction probability. \n The observational process accounts for imperfect detection: during a survey at sites which are truly occupied the species may be either detected or not detection according to detection probability. At sites which are truly unoccupied, the species is never detected – that is, it is assumed that false positive detections do not occur.](Figures/ModelForm.png){#fig-modelform width="1000"}

To distinguish between the ecological and observation processes and estimate the probability of detection, the DOM employs on a hierarchical sampling design depicted in @fig-surveys. Under this design, observations at a site occur during distinct, time-bound seasons in which sites are considered closed to changes in occupancy. Within each season multiple observations are conducted, permitting estimation of the probability of detection conditional on occupancy. Most frequently these observations are collected by revisiting the site on separate occasions, although alternative methods to generate repeat observations exist such as conducting surveys at multiple locations within a site, using of multiple observers during a survey, or recording the time elapsed until a detection is recorded [@mackenzie2005].

![The sampling design of the standard dynamic occupancy model. During seasons, also called 'primary occasions', sites are considered closed to changes in true occupancy state; occupancy state may only change between seasons. Within each season, multiple observations ('secondary occasions') are conducted to record the observed presence or absence of the species at each site. These multiple observations may be recorded in many ways: sites can be revisited multiple times within a season, surveys can be conducted at multiple points within a larger site, multiple observers can conduct surveys contemporaneously, or the time elapsed prior to a detection occurring can be recorded. It is not necessary for the same number of observations to occur in each year or each site, allowing for greater flexibility in data inputs.](Figures/SurveyDesign.png){#fig-surveys fig-align="center" width="589"}

We have presented the standard form of the dynamic occupancy model as described in @mackenzie2003 — numerous model extensions and alternative formulations are also available, including implementations accounting for false positives [@royle2006; @miller2011; @miller2015], multiple states beyond occupied and unoccupied [@nichols2007], and jointly estimated multi-species models[@dorazio2010]. For a comprehensive discussion of the most common extensions and their applications see @bailey2014, as well as @devarajan2020 for a review of multi-species occupancy models.

Dynamic occupancy models make a small number of assumptions with important implications. Firstly, it is assumed that false positive detections do not occur — while this assumption can be safely met in many studies, it is not necessarily guaranteed when working with more cryptic species or less reliable survey methods. Authors have commented on the bias induced when false positives occur and are not accounted for [@mcclintock2010; @miller2015]. Additionally, even genuine detections of a species can be considered 'false positives' when they do not represent the intended definition of occupancy, such as detections of transient individuals when the intent is to estimate breeding occupancy [@berigan2019]. Where this assumption can not reasonably met, the aforementioned extensions designed to account for false positive error should be considered.

A second assumption states that sites are closed to changes in occupancy between seasons. This requirement, best known as the 'closure assumption,' has also been subject to considerable discussion on the bias which is introduced when it is violated [@rota2009; @otto2013]. Closure is dependent not only on the life history of the species, but also on the definition of occupancy used by researchers — short seasons may represent dynamics more representative of species 'use,' and @valente2017 discuss the difficultly in distinguishing temporary emigration and local extinction. Model extensions to relax the closure assumption have been developed, including @kendall2013's approach using staggered arrival and departure periods between sites. More pertinent for most studies, however, is a careful consideration of ecologically and observationally relevant seasons which will allow the estimation of an appropriate 'type' of occupancy, whether that be shorter or longer term.

Generally speaking, DOMs may be applied in much the same ways as SDMs. Comparable probabilities of occupancy may be estimated, relationships to environmental covariates can be quantified, and predictions of occupancy across space and into the future can be generated. Despite these similarities, the two models have developed largely distinctly with key differences in directions within their respective research communities. DOMs originated from the mark-recapture literature, with similarities to models such as the Cormack-Jolly-Seber model [@pollock1990]. This history contributes to an emphasis on imperfect detection and survey design in the DOM literature. In contrast, other areas of the modelling process have received comparatively little attention. For any model estimating occupancy, key environmental drivers must be adequately represented using covariates — the SDM community has long debated how to best approach model selection and evaluation [@guisan2006; @araújo2006; @jarnevich2015; @araújo2019]. The DOM literature has by comparison focused less on these aspects of modelling [@mackenzie2017], although what research does exists indicates that choice of model selection approach can impact model performance [@morin2020].

This review aims to provide an overview of the dynamic occupancy model's first two decades of use. We present a systematic review exploring how authors have used the DOM to answer ecological questions, with emphasis on how they have collected data, selected covariates, and evaluated their models. Based on these results we highlight the DOMs flexibility as a tool for understanding occupancy and discuss common misconceptions regarding their use. We also examine how authors have approached the modelling process and discuss areas where lessons can be drawn from the SDM literature. Finally, we present considerations for authors seeking to use DOMs in their work and outline key priorities and opportunities for future research involving this important model class.

# Systematic review methods

Our review focuses on the dynamic, multi-season implementation of the occupancy model of @mackenzie2003. To meet inclusion criteria articles must have fit a model which i) describes multiple sites which can exist in at least two states, including an occupied and unoccupied states; ii) has multiple survey periods, between which sites may change state conditional on the prior survey period's occupancy state and at least one transition probability; iii) contains at least one detection parameter; and iv) uses real (i.e., not simulated) field ecological data. Papers were gather for inclusion in two stages:

In a preliminary analysis, four search strings ("dynamic occupancy model," "occupancy dynamics model," "incidence function model," and "multi-season occupancy model" were entered into Google Scholar. Up to 100 articles were downloaded for each string, in order of appearance. These articles were divided into four strata based on data of publication — 2000-2005, 2006-2010, 2011-2015, and 2016-2021. For each combination of search string and year strata, a random selection of the greater of 25% of articles or 5 articles was processed. Where available, articles which did not meet inclusion criteria were replaced with another from the same search string and strata.

After completion of the preliminary sample, we noted that the articles from the 'incidence function model' search term represented a distinct model class with its own history and features [@gutiérrez-arellano]. Articles fitting this model were dropped. We also noted that early DOMs used varied terminology to refer to the model and that very few articles were identified from the first few years after their introduction. To better capture these early models and increase the size of our sample, a secondary sample was collected from the complete list of articles which have cited @mackenzie2003, accessed via Web of Science. Articles from this list were split into the same year strata as the first sample, plus an additional 2022-2023 category. 15 articles were drawn from each strata and processed, with replacement from within their strata where necessary.

For each article we recorded key details on authorship, research objectives, study taxa and system, survey methods, and modelling approach. To assess patterns of authorship, the location of each article's first author's primary affiliation was recorded. *All* affiliations for all authors were classified into one of four categories: academic institutions, governmental organisations and institutes, non-governmental organisations, and private sector companies.

We recorded details on the type of taxa (bird, mammal, etc.) modelled in each article, and how multiple species were modelled where applicable. Taxa were denoted as threatened either when they are listed on the IUCN Red List of Species or when authors indicate that they are threatened. This latter determination was made to account for unlisted sub-species or species of local concern. Study locality and size was documented; the size of the study area being defined as the intended area of inference containing all sites, recorded as an order of magnitude to partially account for uncertainty in reporting.

To examine the reasons why authors used DOMs, we allocated each article to one or more category of objective based on the study's stated aims. The possible categories were i) *Estimating parameters*, where authors express interest in estimates of site occupancy, colonisation, extinction, or detection probabilities; ii) *Testing hypotheses*, where authors explore specific predefined relationships between covariates and model parameters; iii) *identifying drivers*, where authors attempt to find which covariates influence model parameters; iv) *generating predictions*, where authors estimate model parameters either for unsurveyed sites or under possible future conditions; and v) *methods development*, where authors introduce, test, or demonstrate aspects of dynamic occupancy models.

Particular emphasis was placed on describing how authors conducted their modelling from covariate selection through model evaluation. We recorded all covariates considered in each study, regardless of whether they were or were not included in final models. Data was collected for each covariate including a general classification, whether it was directly observed or remotely sensed, whether it was static or varied between seasons, and how it was represented in the model - as a linear term, a polynomial term, or as part of an interaction with another covariate. Model selection procedures were sorted into non-exclusive categories including *A priori*, where only one model was considered; *candidate suite*, where a predefined set of models was considered; *procedural*, where covariates were selected parameter-by-parameter; *exhaustive*, where all possible model combinations were fit; *simple precursors*, where selection was preceded by another simpler model implementation; and *other*. Model evaluation was similarly categorised - options in this case included *goodness of fit*, where absolute metrics of fit were used; and *out-of-sample validation* and *in-sample-validation*, where predictive performance was evaluated using in-sample or out-of-sample data respectively.

For the full spreadsheet of data collected and further details on categorisation, see **Appendix I.**

A total of 84 articles were included in this review, 47 from the preliminary sample and 37 from the secondary sample. Based on the acceptance rate from the secondary sample, an estimated 448 of the 1066 articles citing @mackenzie2003 would have met inclusion criteria (@fig-coverage).

![Estimated coverage of articles included in this review, based on the secondary sample's rate of inclusion for each strata.](Figures/CoveragePlot.jpeg){#fig-coverage}

# Applications of dynamic occupancy models

One of the strengths of the dynamic occupancy model is its considerable flexibility across several axes — they may used to achieve several different objectives, fit to diverse forms of occurrence data, and applied to studies at a wide range of spatial and temporal scales. This flexibility is reflected in the types of authors who conducted the studies captured in our sample: while 86% of articles had at least one author based at an academic institution, 46% had author(s) at government institutions and 25% had author(s) from non-profit organisations. The high proportion of articles with government and NGO participants indicates a more applied focus for many users of DOMs, suggesting that model outputs may directly guide management or conservation actions in many cases. The most frequent objective for studies using DOMs was hypothesis testing, with 50% of authors expressing interest in a specific relationship. 31% were interested in identifying nondescript drivers of occupancy, 30% in estimating models parameters like occupancy themselves, and 29% worked to develop and expand on methods for DOMs. Just 10% of authors expressed interest in making predictions to unsurveyed locations or into the future.

Study sites were located in all continents except Antarctica and in 21 countries, with the majority occurring in the United States of America (@fig-StudyDetails A). This strong geographic trend stands in stark contrast with SDMS — @araújo2019's review found that SDMs are far more international, with no continent yielding more than 20% of studies. The reasons behind this disparity are unclear, but one possible explanation may be the DOMs roots in the mark-recapture literature and its history of publication in American journals. These factors may also contribute to the seemingly limited overlap between the bodies of literature for SDMs and DOMs.

Differences in use between SDMs and DOMs are also evident in the species targeted for modelling. Where SDMs show broader coverage of plants, invertebrates, and aquatic species [@araújo2019], 93% of studies in our sample of DOMs modelled terrestrial vertebrate fauna with @belinchón2017's study on lichen the sole non-animal taxa representative (@fig-StudyDetails A). These are also taxa where the DOM's advantages, namely their handling of imperfect detection, are most applicable. One group for which DOMs have only rarely been used is aquatic species, as in @fisher2014's application to invasive salmon or @falke2012's model on Great Plains stream fishes.

40% of the studies in our sample fit models to more than one taxa ('taxa' defined here as one or more species modelled as one). Of these, 75% fit DOMs to multiple species, and 25% fit explicitly multi-species implementations (@fig-StudyDetails B). These multi-species models varied in structure, some taking hierarchical approaches with species-specific effects [@mordecai2009; @lee2017] and others explicitly modelling interactions between species [@lesmeister2015; @fidino2019]. For a more comprehensive discussion on multi-species occupancy modelling, see @devarajan2020's review.

\< FLAG \> discuss how it can be used for large scale monitoring type things where you need to model tons of species — this data already exists for a lot of places. flag paper that fit 300 species, note that there are questions about how to appropriately model them.

One notable finding of our review is the diversity of scale in studies where DOMs have been used. The smallest study area in our sample was less than one kilometre squared, and the largest over one million. Study duration shows similar variation — data collection ran for for less than a month in the shortest study, and for 40 years in the longest, with a median duration of 3.25 years. This reiterates the flexibility of dynamic occupancy models, with explorations of hyper-local patterns of occupancy and analyses of continental-scale distribution using the same underlying model structure. The detection data collected from these surveys came from a variety of detection methods: 69% of articles used human observations, 20% conducted live trapping, 12% used camera traps, and 1% used bioacoustic monitors (@fig-StudyDetails); some also incorporated data from multiple detection sources.

![A) Study areas: Data for a majority of studies were collected from study locations in the United States. The size of study areas was log-normally distributed, with the median study area falling between 1000 and 10000 square kilometres. \n B) Study taxa: Most species modelled in our sample were terrestrial vertebrates including birds, mammals, or herptiles. 50 articles fit models to only a single taxa, 26 fit independent models to multiple taxa, and 8 fit multi-species models with explicit interactions between taxa. \n C) Survey methods: Approaches to data collected were varied and included conventional surveys like point counts and transects as well as more modern methods like camera traps and acoustic monitors. 10 articles incorporated data from citizen science projects. Project scale was also variable, with the median study running for 3.25 years and covering 98 sites.](Figures/ReviewBox.png){#fig-StudyDetails}

It is important to note that the data input requirements for dynamic occupancy models are not as arduous as may be commonly perceived. While it *is* necessary to record multiple observations at individual sites, this does not necessarily require that data be collected according to a strict, preconceived sampling scheme. Post-hoc manipulation of other data such as long-term citizen monitoring programs [@zuckerberg2011; @peach2019], disparate agency modelling programs [@mcgowan2020], or camera trapping data [@davis2018] is feasible with careful consideration. In one example, @riddell2021 used data from as long ago as 1908 by treating grid cells as sites and counting historical surveys within each cell as repeat observations. In a similar vein, data does not necessarily need to come from the same source. Detections from multiple methods, with associated variation in detection probabilities, have also been incorporated by authors [@warrier2020; @pitman2017].

The proliferation of modern survey techniques like camera traps and bioacoustic monitors has also led to an increase in datasets suitable for the dynamic occupancy model. The DOM is a valuable tool for analysing these data [@balantic2019]

Modern survey techniques like camera traps and bioacoustic monitors create other opportunities for modelling, and questions remain on the best ways to approach handling such large quantities of data. One interesting possibility is the use of large numbers of extremely short seasons, which is rarely feasible when using human survey data — @kleiven2020 and @mölle2022 divided their camera trap records into seasons of just a few days, modelling patterns of occupancy at a fine temporal scale. It is important to note that this substantially alters how model outputs should be interpreted, and a larger discussion on this topic is necessary.

The DOMs ability to make predictions has been often underexploited in the existing literature, given its broad potential for the use-case [@kéry2013; @briscoe2021]. Articles which do make predictions provide some of the most directly applicable outputs found in the review sample: @mcgowan2020 provides projections for a threatened species under multiple putative management scenarios, and @pollentier2021 generates maps of distributions more frequently associated with species distribution models (SDMs).

# Current modelling practices

Reviewed articles have approached the modelling pro

A summary of covariates considered in the review sample is presented in @tbl-covariates. For each category of covariate relative frequency and characteristics are given. For all categories, the rate of consideration of polynomial terms does not exceed 16%, and the rate of consideration of interactions does not exceed 34%.

::: column-page-inset
```{r covariate table}
#| echo: false
#| message: false
#| label: tbl-covariates
#| tbl-cap: "All covariates considered for inclusion in a study were classified into mutually exclusive categories. For each parameter (initial occupancy, colonisation, extinction, and detection), the percentage of studies including at least one covariate in a given category is presented. We also present the percentage of covariates in each category which are dynamic (change throughout seasons) or require direct observation (e.g. are not remotely sensed). The percentage of covariates in each category for which non-linear representations or interactions with other covariates were considered is given to indicate which were most likely to be included as more complex terms."

library(tidyverse)
library(gt)

covTable <- read_csv("Figures/CovariateTable.csv")

covTable |>
  arrange(Category, -Overall_Proportion) |>
  gt(rowname_col = "Type") |>
  tab_header("Covariate attributes") |>
  tab_row_group(
    label = md("Environmental covariates"),
    rows = Category == "Environmental",
    id = "Env"
  ) |>
  tab_row_group(
    label = md("Other covariates"),
    rows = Category == "Other",
    id = "Other"
  ) |>
  tab_style(
    style = cell_fill(color = "#82AD8E"),
    locations = cells_row_groups(groups = "Env")
  ) |>
  tab_style(
    style = list(
      cell_fill(color = "gray70")
    ),
    locations = cells_row_groups(groups = "Other")
  ) |>
  row_group_order(groups = c("Env", "Other")) |>
  tab_spanner(label = "Articles with covariate on:",
              columns = c("Overall_Proportion", "InitOcc_Proportion",
                          "Colonisation_Proportion", 
                          "Extinction_Proportion",
                          "Detection_Proportion"),
              id = "articles") |>
  tab_spanner(label = "Covariates which are:",
              columns = c(Proportion_Dynamic, Proportion_Observed),
              id = "covariates") |>
  tab_spanner(label = "Represented as:",
                columns = c(Proportion_Polynomial, Proportion_Interact),
                id = "representations") |>
   cols_label(
    Overall_Proportion = "Any parameter",
    InitOcc_Proportion = "Initial Occ.",
    Colonisation_Proportion = "Colonisation",
    Extinction_Proportion = "Extinction",
    Detection_Proportion = "Detection",
    Proportion_Dynamic = "Dynamic",
    Proportion_Observed = "Directly observed",
    Proportion_Polynomial = "Non-linear",
    Proportion_Interact = "Interaction"
  ) |>
  cols_hide(Category) |>
  fmt_percent(decimals = 0) |>
  sub_missing(missing_text = "-")|>
  tab_style(style = cell_fill(color = "lavender"),
            locations = cells_body(columns = Overall_Proportion,
                                   rows = Overall_Proportion == max(Overall_Proportion, na.rm = TRUE))) |>
    tab_style(style = cell_fill(color = "lavender"),
            locations = cells_body(columns = InitOcc_Proportion,
                                   rows = InitOcc_Proportion == max(InitOcc_Proportion, na.rm = TRUE))) |>
    tab_style(style = cell_fill(color = "lavender"),
            locations = cells_body(columns = Colonisation_Proportion,
                                   rows = Colonisation_Proportion == max(Colonisation_Proportion, na.rm = TRUE))) |>
    tab_style(style = cell_fill(color = "lavender"),
            locations = cells_body(columns = Extinction_Proportion,
                                   rows = Extinction_Proportion == max(Extinction_Proportion, na.rm = TRUE))) |>
    tab_style(style = cell_fill(color = "lavender"),
            locations = cells_body(columns = Detection_Proportion,
                                   rows = Detection_Proportion == max(Detection_Proportion, na.rm = TRUE))) |>
    tab_style(style = cell_fill(color = "lavender"),
            locations = cells_body(columns = Proportion_Dynamic,
                                   rows = Proportion_Dynamic == max(Proportion_Dynamic, na.rm = TRUE))) |>
    tab_style(style = cell_fill(color = "lavender"),
            locations = cells_body(columns = Proportion_Observed,
                                   rows = Proportion_Observed == max(Proportion_Observed, na.rm = TRUE))) |>
    tab_style(style = cell_fill(color = "lavender"),
            locations = cells_body(columns = Proportion_Polynomial,
                                   rows = Proportion_Polynomial == max(Proportion_Polynomial, na.rm = TRUE))) |>
    tab_style(style = cell_fill(color = "lavender"),
            locations = cells_body(columns = Proportion_Interact,
                                   rows = Proportion_Interact == max(Proportion_Interact, na.rm = TRUE))) |>
  as_raw_html()
  
```
:::

The number of covariates considered varied considerably, both between studies and between parameters as shown in @fig-covariates. Of the four standard model parameters, models were least likely to consider covariates for initial occupancy (35% of articles with zero covariates considered), and most likely to consider them for detection (81% of articles with at least one covariate considered).

![Distribution of covariate quantity considered for model parameters across articles.](Figures/CovParamPlot.jpeg){#fig-covariates}

Model complexity varies with the stated objectives of articles, with those focussed on making predictions and identifying drivers of occupancy being more likely to consider a larger number of covariates (@tbl-objectives). These articles were also more likely to represent covariates in more complex ways by considering non-linear responses and interactions between covariates. Articles with objectives involving methods development considered fewer covariates and were less likely to use these more complex formulations.

<div>

```{r Objectives table}
#| echo: false
#| message: false
#| label: tbl-objectives
#| tbl-cap: "Implementation of models by study objective. Models were assessed based on the number of covariates considered, the inclusion of non-linear responses and interactions between covaraites, the manner of model selection, and whether or not they objectively evaluated model performance."

objTable <- read_csv("Figures/ObjectiveTable.csv")

objTable |>
  mutate(Objective = fct(Objective,
                         levels = c("Hypothesis", "Drivers", "Parameters",
                                    "Methods", "Predict", "Any"))) |>
  arrange(Objective) |>
  mutate(Objective = case_when(Objective == "Hypothesis" ~ "Testing hypotheses",
                               Objective == "Drivers" ~ "Identifying drivers",
                               Objective == "Predict" ~ "Making predictions",
                               Objective == "Methods" ~ "Developing methods",
                               Objective == "Parameters" ~ "Estimating parameters",
                               Objective == "Any" ~ "Any objective")) |>
  gt(rowname_col = "Objective") |>
  tab_spanner(label = "Articles",
              columns = c("Articles", "ArticlesProp"),
              id = "articles") |>
  tab_spanner(label = "Percent which have:",
              columns = c("ProbPoly", "ProbInt",
                          "ProbEval", "ProbSelect"),
              id = "percents") |>
  cols_label(Articles = "n", ArticlesProp = "%",
             MedianCovs = "Median covariates considered",
             ProbPoly = "Non-linear responses",
             ProbInt = "Covariate interactions",
             ProbSelect = "Model selection",
             ProbEval = "Model evaluation / goodness of fit") |>
  fmt_percent(columns = c(ArticlesProp, 
                          ProbPoly, ProbInt, 
                          ProbEval, ProbSelect),
              decimals = 0) |>
  tab_style(style = list(cell_fill(color = "gray80"),
                         cell_text(style = "italic")),
            locations = cells_body(rows = Objective == "Any objective")) |>
  tab_style(style = cell_fill(color = "lavender"),
            locations = cells_body(columns = MedianCovs,
                                   rows = MedianCovs == max(MedianCovs, na.rm = TRUE))) |>
  tab_style(style = cell_fill(color = "lavender"),
            locations = cells_body(columns = ProbPoly,
                                   rows = ProbPoly == max(ProbPoly, na.rm = TRUE))) |>
  tab_style(style = cell_fill(color = "lavender"),
            locations = cells_body(columns = ProbInt,
                                   rows = ProbInt == max(ProbInt, na.rm = TRUE))) |>
  tab_style(style = cell_fill(color = "lavender"),
            locations = cells_body(columns = ProbEval,
                                   rows = ProbEval == max(ProbEval, na.rm = TRUE))) |>
  tab_style(style = cell_fill(color = "lavender"),
            locations = cells_body(columns = ProbSelect,
                                   rows = ProbSelect == max(ProbSelect, na.rm = TRUE))) |>
  as_raw_html()
```

</div>

Bayesian models were far less likely to be implemented using a model selection protocol compared to frequentist models: 70% of the former fit only a single model defined *a priori,* compared to 10% of the latter (@fig-selection). In frequentist models, sequential selection protocols in which parameters are fixed one by one were the most popular choice. Nearly all frequentist models used AIC or AICc to identify their best model.

![Frequency of use for model selection methods. 'Single model' indicates no model selection occurred, 'candidate suite' includes studies which compared a predefined set of models, articles with 'procedural selection' fit parameters one-by-one, 'exhaustive selection' fit all possible combinations of models, and 'simple precursor' describes where results of a less-complex model were used to inform covariate choice.](Figures/SelectionFigure.jpeg){#fig-selection}

Model evaluation and absolute assessment of model fit was rare throughout the sample regardless of selection protocol. Only 8% of articles calculated non-relative metrics, either via in-sample validation, bootstrapped goodness-of-fit tests, or out-of-sample validation.

# Conclusions and key priorities

# OLD —

# Discussion

One of the strengths of the dynamic occupancy model is its considerable flexibility — as seen in our review, applications of DOMs over the past two decades have been fit to data for a diverse cohort of species, using a broad range of detection methods and survey designs. This flexibility permits quite a bit of creativity on the part of authors and has allowed for innovative use-cases well beyond simple estimations of occupancy. Despite this promise, questions do remain on the best practices for fitting DOMs. Studies in our sample are discordant on their approaches the modelling process, and there the literature gives little insight on how these approaches may differ in their ability to identify reliable models.

## Uses and broader potential

## Outstanding questions on approaches to modelling

## Key considerations for users

# Conclusion

### Applications of dynamic occupancy models

DOMs display great variation of scale in all senses. Analyses in our samples range from the hyper-local at individual parks [@zúñiga-vega2019] to continental-scale studies [@zuckerberg2011]. Similar diversity in study duration and site quantity indicates further emphasises the breadth of studies which DOMs may be fit to. Method of species detection also need not be a limitation for the implementation of DOMs, as articles in our sample show that many approaches may be coerced into data suitable for this model class. While studies pre-designed to match hierarchical data inputs may be simplest to align with model assumptions, post-hoc manipulation of other data such as long-term citizen monitoring programs [@zuckerberg2011; @peach2019], disparate agency modelling programs [@mcgowan2020], or camera trapping data [@davis2018] is feasible with careful consideration. Detections from multiple sources, with associated variation in efficiency, have also been incorporated by authors [@warrier2020; @pitman2017].

Reviewed implementations of dynamic occupancy models show widespread representation from mammals, birds, and herptiles. This assemblage contrasts with the related stochastic patch occupancy models (SPOMs, @gutiérrez-arellano), where the majority of models are fit to invertebrates, plants, and fungi. This difference may reflect SPOMs' assumption of perfect detection and discrete habitat patches, limitations which are unlikely to be fulfilled by most vertebrate taxa. Aside from differences in assumptions around detection, SPOMs also differ from DOMs in that they are generally spatially explicit, with probabilities of colonisation and extinction dependent on patch size and the occupancy state of nearby patches. Where desired, these features may also added to dynamic occupancy models — @sutherland2014 presents an implementation which may be considered a fusion of the DOM and SPOM methods, and several other authors incorporate patch characteristics aspects into their models as covariates [@duggan2011; @broms2016].

While objectives vary in our sample, DOMs are rarely used to extrapolate beyond study areas — use of prediction remains the least popular use-case in our sample. Articles which do make predictions provide some of the most directly applicable outputs found in the review sample: @mcgowan2020 provides projections for a threatened species under multiple putative management scenarios, and @pollentier2021 generates maps of distributions more frequently associated with species distribution models (SDMs). DOMs offer advantages over other SDMs for this purpose, particularly where populations are assumed not to be at equilibrium as is the case for many threatened and invasive species. By explicitly accounting for changes in occupancy (i.e., colonisation and extinction) DOMs may better capture future range contraction or expansion — an aspect of prediction where other SDMs may struggle.

### Practices in the modelling process

A diverse set of covariates were identified in the model sample reflecting the diversity of systems and ecological questions described by DOMs. Notably, many models lack covariates on the initial occupancy parameter, raising questions on how the parameterisation of the model in it's first time-step may affect the quality of estimates at later time-steps. The distinction in covariates considered for the ecological parameters vs those considered for detection is also of note: ecological parameters more frequently contained covariates describing environmental features, where detection more frequently contained more structural covariates such as season. Covariate complexity is relatively low across the board, with only a fraction of models implementing either non-linear responses to covariates or interactions between covariates. While this addition complexity does have implications for model selection, it may be necessary to accurately describe many ecological relationships.

Model selection approaches diverge between Bayesian and frequentist implementations of the model. While model selection will naturally be practised differently between these two categories, it is unclear what effect a lack of model selection may have on the outputs produced by Bayesian models, and it is likely that Bayesian model selection approaches should be further explored @hooten2015. Model selection approaches in the Frequentist applications show limited consensus, although most do consider multiple models. Notably, @morin2020 found that the popular procedural approaches to model selection (where one sub-model is assessed at a time) may not provide optimal results. Considerably more research is required on this topic to clarify how authors should best approach covariate selection.

### Key considerations for model users

Implementation of dynamic occupancy models requires considerable thought to ensure that model outputs correspond with author expectations and ecological realities. Based upon our review of the existing literature we discuss key questions authors should carefully engage with during the modelling process.

1.  **Are seasons ecologically meaningful, and how do they affect the definition of occupancy?** As previously discussed, the duration of the season has important implications for both the reliability and proper interpretation of model results. Seasons which are not ecologically meaningful may run afoul of the closure assumption resulting in associated biases. Also relevant is how the definition of 'occupancy' may shift with season length and life-history of a species — for many species, occupancy within a year and within a week may be considerably different concepts, with shorter intervals more closely relating to the idea of 'use.' With the proliferation of continuous detection methods such as camera traps and acoustic monitors where the definition of 'season' is to some degree arbitrary, it is increasingly important to thoughtfully consider how this element of the DOM is defined.

2.  **Are key drivers of occupancy and detection incorporated?** While it is effectively impossible to *fully* describe heterogeneity across a landscape, authors should make their best efforts to capture the drivers of occupancy and detection most likely to influence their study species. This is true even when another covariate is of principal interest to investigators — failure to include other major determinants of occupancy is likely to bias parameter estimates. One place where this is of particular importance is in determining drivers of detection, which is not only subject to observational conditions but also ecological determinants which may cause the species to spend more time at a location and thus be more frequently available for detection.

3.  **Ensure covariates reflect ecological complexity.** Many ecological relationships are non-linear and may require polynomial terms to be accurately represented. This is particularly true at large spatial scales where a larger portion of a species ecological niche is represented in surveyed data. Authors should question whether a linear term is sufficient to capture hypothetical relationships in their study systems, and consider quadratic terms as well as interactions between covariates where appropriate.

4.  **Consider model evaluation.** Model evaluation remains rare in ecological research relative to other fields embracing complex modelling, likely due to a reluctance to 'throw away' data for use in testing. This concept should be challenged, particularly for larger scale long-term projects where reserving a fraction of data for testing is unlikely to substantially reduce precision of parameter estimates. For studies where this is genuinely not possible, reporting results of goodness-of-fit tests may still provide valuable information to readers.

### Priorities for future research

Work on dynamic occupancy modelling over the past 20 years has developed this model class into an important tool for describing species distributions and ecological relationships. Historically, methods-development research for dynamic occupancy models has focused on questions of model structure — namely ideas around the closure assumption and imperfect detection. This emphasis likely reflects the DOM's roots in the mark-recapture literature, where these topics have been discussed for several decades. Considerably less emphasis has been placed on the relation of model parameters to environmental factors via covariates and the model selection processes used to do so, despite this being an objective in a considerable fraction of studies fitting DOMs. This stands in stark contrast to related correlative species distribution models, where these topics have been the subject of considerable research over the years. There are opportunities for the DOM literature to learn from species distribution models, and more targeted research on the influence of the model selection process is necessary.

An important opportunity for future research relates to autonomous detection methods, such as camera traps and bio-acoustic monitors — these technologies have permitted collection of enormous quantities of data particularly well-suited to dynamic occupancy models, but have also raised additional questions around their implementation. The definition of seasons is of increased importance for these data types, where division of data into 'seasons' and 'observations' is arbitrary. Further research should explore the implications of this phenomenon and the additional modelling opportunities made possible by this novel data type.

The past two decades have shown that dynamic occupancy models are an excellent tool for addressing a wide range of ecological questions relating to species occupancy throughout space and time. The flexibility afforded by model extensions and the considerable advantages of the class over other species distribution models is likely to ensure that these models continue to increase in popularity. Given their strong use on threatened taxa and excellent potential to support environmental management, it is important that research continues to support model users in creating the most reliable models possible.

## old

First-authors of studies came from a total of 15 countries, with authors in the United States producing 64% of articles. 86% of articles had at least one author based at an academic institution, 46% had author(s) at government institutions, and 25% had author(s) from non-profit organisations.

## Study locations, focal species, and data collection

Data for DOMs were collected from study areas on all continents and in 21 countries, with studies in the United States again representing a majority of the total articles published. These study areas ranged in size from less than 1 to over 1 million square kilometres (@fig-StudyDetails a).

Focal species were largely vertebrate taxa, although 6 articles in the sample fit models to invertebrates. A single non-animal taxa was represented in the sample, from an article fitting a DOM to a rare species of lichen [@belinchón2017]. 35% of articles modelled threatened taxa, and 10% modelled species invasive to the study area. Most articles (50, 60%) fit single-species DOMs to one taxa. Of the remainder, 26 (31%) fit independent single-species models to more than one taxa. 8 articles fit (10%) multi-species implementations with explicit interactions between species (@fig-StudyDetails b).

Data used to fit DOMs included human survey data such as transects or point counts (69% of articles), live-trapping data (20%), camera traps (12%) or bioacoustic monitors (1%), and citizen science data (12%); some articles incorporate multiple detection methods to build their detection datasets. Study duration, defined as the time elapsed between the first and last surveys conducted, ranged from 1 month to 40 years with the median study running for 3.25 years. The number of seasons ranged from 2 to 204 with a median of 5; the number of observations per season ranged from 2 to 153 with a median of 5. The number of sites surveyed per article ranged from 7 to 9394, with the median study including 98 sites (@fig-StudyDetails c).
