---
title: "Twenty years of dynamic occupancy models: a review of applications and a look towards the future"
date: today

authors:
  - name: Saoirse Kelleher
    affiliation: University of Melbourne
    email: saoirse.kelleher@student.unimelb.edu.au
    orcid: 0000-0002-4614-5753
    corresponding: true
  - name: Natalie Briscoe
    affiliation: University of Melbourne
  - name: Gurutzeta Guillera-Arroita
    affiliation: Pyrenean Institute of Ecology, Spanish National Research Council
  - name: Jane Elith
    affiliation: University of Melbourne
    
abstract: | 
  Describing patterns of species occupancy across landscapes and throughout time is a fundamental aspect of much ecological research. The dynamic multi-season occupancy model is an important tool for analysing wildlife occurence data -- by explicitly estimating colonisation and extinction probabilities while accounting for imperfect detection, it strikes a favourable balance between realism and feasibility. These models can be used in similar ways to more conventional species distribution models, which can struggle to deal with imperfect detection and non-equilibrium populations.
  
  We present a review of applications of the dynamic occupancy model in the twenty years since its initial publication. Our findings indicate that this model demonstrates exceptional flexibility with suitability to address a wide range of ecological questions, and that it may have  broader potential than commonly thought. We also note that practices in fitting dynamic occupancy models are highly variable, and that the existing literature lacks clear answers for best practices. This contrasts with the strong focus on modelling practices in the species distribution model literature, which we suggest may be a valuable resource for improving how authors implement dynamic occupancy models.

bibliography: references.bib
---

# Introduction

Ecologists have long sought to describe the processes by which species are distributed across landscapes and throughout time [@humboldt1849], and an understanding of where a species exists, which factors lead to its presence, and how its distribution may change is ever more important in a dynamic and changing world. Descriptions of how widespread a species is and where it occurs are the foundation of monitoring programs and are imperative for assessing conservation status, and further untangling the drivers of occurrence can help us to better understand a species life history and inform potential management actions. Robust knowledge of the occupancy patterns of a species also helps us to predict where a species is most likely to occur — now, and under hypothetical future scenarios.

The need to reliably describe species occupancy has led to the development of many quantitative approaches, of which the best known are species distribution models [SDMs, @elith2009]. The prototypical SDM correlates records of species occurrence with environmental features to determine where species are most probable to occur. While SDMs are an exceedingly popular tool for describing occupancy, the most frequently used implementations are known to struggle under certain common scenarios. First and foremost, SDMs do not typically account for imperfect detection, a near-ubiquitous characteristic of wildlife field data that can lead to meaningful bias in estimates of occupancy [@lahoz-monfort2014; @guillera-arroita2017; @gu2004]. Secondly, SDMs have been noted to perform poorly when a species' distribution is not at equilibrium [@elith2010]. These shortcomings may be problematic when working with invasive species or species whose ranges are expanding or contracting, all increasingly common scenarios in the Anthropocene [@bertelsmeier2013; @lenoir2015].

The dynamic occupancy model (DOM, also termed 'multi-season occupancy model') introduced in @mackenzie2003 provides an alternative framework to modelling occurrence and distributions. The DOM, an extension of @mackenzie2002's static occupancy model, explicitly describes the colonisation and extinction processes which guide occupancy while accounting for imperfect detection. By incorporating these process-explicit elements, the DOM offers more advanced insights than simpler static species distribution models and accounts for their major weaknesses. Despite their added complexity, input data requirements remain more achievable compared to other more complex process-explicit models, enhancing their suitability to applied questions in ecology.

### Dynamic occupancy model form and assumptions

Dynamic occupancy models unite two processes: the ecological process of site occupancy describes the presence or absence of a species at a site at any point in time, and the observational process of detection describing whether a species is observed given that a site is occupied (@fig-modelform). Under this parameterisation, sites exist in either occupied or unoccupied states. The occupancy state for each site in the first time-step is given by an initial occupancy parameter which itself resembles a static SDM. In ensuing time-steps, occupancy state is predicated on the site's previous state and probabilities of colonisation and extinction. When surveys are conducted at an occupied site, the probability that the species is observed is given by the detection probability. In the DOM's standard form, it is assumed that detections never occur at unoccupied sites; that is, that false-positive detections do not occur.

![The original parameterisation of the dynamic occupancy model as described by @mackenzie2003. The occupancy state of any given site is described in the ecological process. In the first season, occupancy is determined by the *initial occupancy* parameter. In subsequent season, unoccupied sites may become occupied according to the colonisation probability and occupied sites may become unoccupied according to the extinction probability. \n The observational process accounts for imperfect detection: during a survey at sites which are truly occupied the species may be either detected or not detection according to detection probability. At sites which are truly unoccupied, the species is never detected – that is, it is assumed that false positive detections do not occur.](Figures/ModelForm.png){#fig-modelform width="1000"}

To disentangle the ecological and observational processes, the DOM requires a hierarchical sampling design as depicted in @fig-surveys. Under this design, observations at a site occur during distinct, time-bound seasons in which sites are considered closed to changes in occupancy. Within each season multiple observations are conducted, permitting estimation of the probability of detection conditional on occupancy. Most frequently these repeat observations are collected by revisiting the site on separate occasions, although they can also be attained by alternative means: examples include conducting surveys at multiple locations within a site, using multiple observers during a survey, or recording the time elapsed until a detection is recorded [@mackenzie2005].

![The sampling design of the standard dynamic occupancy model. During seasons, also called 'primary occasions', sites are considered closed to changes in true occupancy state; occupancy state may only change between seasons. Within each season, multiple observations ('secondary occasions') are conducted to record the observed presence or absence of the species at each site. These multiple observations may be recorded in many ways: sites can be revisited multiple times within a season, surveys can be conducted at multiple points within a larger site, multiple observers can conduct surveys contemporaneously, or the time elapsed prior to a detection occurring can be recorded. It is not necessary for the same number of observations to occur in each year or each site, allowing for greater flexibility in data inputs.](Figures/SurveyDesign.png){#fig-surveys fig-align="center" width="589"}

These descriptions represent only the original form of the dynamic occupancy model as prescribed in @mackenzie2003. Numerous model extensions and alternative formulations are also available, including implementations accounting for false positives [@royle2006; @miller2011; @miller2015], multiple states beyond occupied and unoccupied [@nichols2007], and jointly estimated multi-species models[@dorazio2010]. For a comprehensive discussion of the most common extensions and their applications see @bailey2014, as well as @devarajan2020 for a review of multi-species occupancy models.

Dynamic occupancy models make a small number of assumptions with important implications. Firstly, it is assumed that false positive detections do not occur — while this assumption can be safely met in many studies, it is not necessarily guaranteed when working with more cryptic species or less reliable survey methods. Authors have commented on the bias induced when false positives occur and are not accounted for [@mcclintock2010; @miller2015]. Additionally, even genuine detections of a species can be considered 'false positives' when they do not represent the intended definition of occupancy, such as detections of transient individuals when the intent is to estimate breeding occupancy [@berigan2019]. Where this assumption can not reasonably met, the aforementioned extensions designed to account for false positive error should be considered.

A second assumption states that sites are closed to changes in occupancy between seasons. This requirement, best known as the 'closure assumption,' has also been subject to considerable discussion around the bias which is introduced when it is violated [@rota2009; @otto2013]. Closure is dependent not only on the life history of the species, but also on the definition of occupancy used by researchers — short seasons may represent dynamics more representative of species 'use,' and @valente2017 discuss the difficultly in distinguishing between temporary emigration and local extinction. Model extensions to relax the closure assumption have been developed, including @kendall2013's approach using staggered arrival and departure periods between sites. A more pertinent approach for most studies, however, is careful consideration of ecologically relevant seasons corresponding to an appropriate definition of occupancy.

Each of the DOM's main parameters (Initial occupancy, Colonisation, Extinction, and Detection) can be estimated with covariates to capture spatial or temporal variation. As with any model, it is assumed that heterogeneity in the study system is reasonably captured by these covariates. While the importance of relating the ecological parameters to the environment is generally understood, representation of heterogeneity in the Detection probability is particularly nuanced and may be easily misinterpreted. The likelihood of detecting a species depends not only on the factors influencing observability (e.g. survey efficiency, weather, etc.), but also on factors like habitat suitability which influence species abundance and activity [@guillera-arroita2017]; failing to account for these factors when modelling detections may risk biasing model outputs.

### Review aims and objectives

DOMs and SDMs have similarities in their application and outputs. Using either model, comparable probabilities of occupancy may be estimated, relationships to environmental covariates can be quantified, and predictions of occupancy across space and into the future can be generated. Despite these parallels, the two models have developed largely distinctly with differences in priorities within their respective research communities. From their beginnings, SDMs have sought to relate species occurrence to environmental factors — this is reflected in their literature, which has extensively discussed how best to incorporate covariates in models [@araújo2006; @guisan2006; @elith2006]. On the other hand, the DOM has its origins in the mark-recapture literature with pointed similarities to methods like the Cormack-Jolly-Seber model which also relies on a similar sampling scheme [@pollock1990]. This history has contributed to an emphasis on imperfect detection and survey design in the DOM literature, while other areas of the modelling process have received comparatively little attention [@mackenzie2017].

This review aims to provide an overview of how dynamic occupancy models have been applied and implemented in their first two decades of use. We present a systematic review exploring how authors have used the DOM to answer ecological questions, with emphasis on how they have collected data, selected covariates, and evaluated their models. Based on these results we highlight the DOMs flexibility as a tool for understanding occupancy and discuss further opportunities where they may be of use. We also examine how authors have approached the modelling process and discuss key areas where lessons can be drawn from the SDM literature. Finally, we present considerations for authors seeking to use DOMs in their work and outline key priorities for future research involving this important model class.

# Systematic review methods

Our review is focused on applications of the dynamic, multi-season occupancy model of @mackenzie2003 and its extensions. To reflect this, we included articles which fit a model meeting the following criteria:

I.  Uses non-simulated, field-collected presence-absence data.

II. Describes multiple sites which can exist in at least two states including *occupied* and *unoccupied.*

III. Has multiple seasons, between which sites may change states conditional on the prior season's occupancy state and transition probabilities such as colonisation and extinction.

IV. Contains at least one parameter describing the detection process.

We gathered a representative sample of studies meeting these criteria in two stages. In a preliminary analysis, four search strings ("dynamic occupancy model," "occupancy dynamics model," "incidence function model," and "multi-season occupancy model") were entered into Google Scholar. Up to 100 articles were downloaded for each string, in order of appearance. These articles were divided into four strata based on data of publication — 2000-2005, 2006-2010, 2011-2015, and 2016-2021. For each combination of search string and year strata, a random 5 articles or 25% of the strata (whichever was greater) was processed. Where available, articles which did not meet inclusion criteria were replaced with another from the same search string and strata combination.

After completion of the preliminary sample, we noted that the articles from the 'incidence function model' search term represented a distinct model class with its own history and features: also called 'stochastic patch occupancy models' or 'Hanski models', these generally focus on small-scale patch dynamics and do not typically account for imperfect detection [@gutiérrez-arellano], hence these articles were removed from the sample. We also noted that early DOMs used varied terminology to refer to the model and that very few articles were identified from the first few years after their introduction. To better capture these early models and increase the size of our sample, a secondary sample was collected from the complete list of articles which have cited @mackenzie2003, accessed via Web of Science. Articles from this list were split into the same year strata as the first sample plus an additional 2022-2023 category. 15 articles were drawn from each strata and processed, with replacement from within their strata where necessary.

For each article we recorded key details on authorship, research objectives, study taxa and system, survey methods, and modelling approach. To assess patterns of authorship, the location of each article's first author's primary affiliation was recorded. *All* affiliations for all authors were classified into one of four categories: academic institutions, governmental organisations and institutes, non-governmental organisations, and private sector companies.

We recorded details on the type of taxa (bird, mammal, etc.) modelled in each article, and how multiple species were modelled where applicable. Taxa were denoted as threatened either when they are listed on the IUCN Red List of Species or when authors otherwise indicate that they are threatened. This deference to authors' representation of conservation status was made to account for sub-species which lack listings or species which are of more local concern. Study locality and size was documented; the size of the study area being defined as the intended area of inference containing all sites, recorded as an order of magnitude to partially account for uncertainty in reporting.

To examine the reasons why authors used DOMs, we allocated each article to one or more category of objective based on the study's stated aims. The possible categories were *Estimating parameters*, where authors express interest in estimates of site occupancy, colonisation, extinction, or detection probabilities; *Testing hypotheses*, where authors explore specific predefined relationships between covariates and model parameters; *Identifying drivers*, where authors attempt to find which covariates influence model parameters; *Generating predictions*, where authors estimate model parameters either for unsurveyed sites or under possible future conditions; and *Methods development*, where authors introduce, test, or demonstrate aspects of dynamic occupancy models.

Particular emphasis was placed on describing how authors conducted their modelling from covariate selection through model evaluation. We recorded all covariates considered in each study, regardless of whether they were or were not included in final models. Key traits of each covariate were recorded including their general category, whether they were directly observed or remotely sensed, whether they were static or varied between seasons, and how they were represented in the model (as a linear term, a polynomial term, or as part of an interaction with another covariate). Model selection procedures were sorted into non-exclusive categories including *A priori*, where only one model was considered; *candidate suite*, where a predefined set of models was considered; *procedural*, where covariates were selected parameter-by-parameter; *exhaustive*, where all possible model combinations were fit; *simple precursors*, where selection was preceded by another simpler model implementation; and *other*. Model evaluation was similarly categorised - options in this case included *goodness of fit*, where absolute metrics of fit were used; and *out-of-sample validation* and *in-sample-validation*, where predictive performance was evaluated using in-sample or out-of-sample data respectively. For the full spreadsheet of data collected and further details on categorisation, see **Appendix I.**

A total of 84 articles were included in this review, 47 from the preliminary sample and 37 from the secondary sample. Based on the acceptance rate from the secondary sample, an estimated 448 of the 1066 articles citing @mackenzie2003 would have met inclusion criteria (@fig-coverage).

![Estimated coverage of articles included in this review, based on the secondary sample's rate of inclusion for each strata.](Figures/CoveragePlot.jpeg){#fig-coverage}

# Applications of dynamic occupancy models

Dynamic occupancy models are considerably flexible in many ways: they may used to achieve several different objectives, fit to occurrence data collected by various methods, and applied to studies at a wide range of spatial and temporal scales. Some of this diversity in study locations, focal taxa, and survey methods amongst the reviewed studies is presented in @fig-StudyDetails.

![A) Study areas: Data for a majority of studies were collected from study locations in the United States. The size of study areas was log-normally distributed, with the median study area falling between 1000 and 10000 square kilometres. \n B) Study taxa: Most species modelled in our sample were terrestrial vertebrates including birds, mammals, or herptiles. 50 articles fit models to only a single taxa, 26 fit independent models to multiple taxa, and 8 fit multi-species models with explicit interactions between taxa. \n C) Survey methods: Approaches to data collected were varied and included conventional surveys like point counts and transects as well as more modern methods like camera traps and acoustic monitors. 10 articles incorporated data from citizen science projects. Project scale was also variable, with the median study running for 3.25 years and covering 98 sites.](Figures/ReviewBox.png){#fig-StudyDetails}

### Focal systems

Although studies were conducted in 21 countries and on all continents except for Antarctica, the majority of reviewed articles used data collected in the United States of America. This strong geographic trend starkly contrasts with SDMs far more international reach; @araújo2019's review of SDM applications found that no more than 20% of studies came from any single continent. The reasons behind this disparity are unclear, but a possible explanation could relate to the DOM's roots in the mark-recapture literature and a history of publication in American journals. These differences in where users conduct their research may also contribute to the seemingly limited overlap between these models' respective bodies of literature.

Differences in use between SDMs and DOMs are also evident in the species targeted for modelling. Where SDMs show broader coverage of plants, invertebrates, and aquatic species [@araújo2019], 93% of studies in our sample of DOMs modelled terrestrial vertebrate fauna with @belinchón2017's study on lichen the sole non-animal taxa representative. These differences are most easily explained by the DOM's emphasis on imperfect detection, a concern which is less prioritised (though not non-existent [@chen2013]) in studies on non-mobile species like plants. We find DOMs have been frequently used to model threatened taxa (32% of studies) and invasive species (11% of studies), taxa for which they may be expected to excel due to their more explicit handling of changes in occupancy. One group for which DOMs have only rarely been used is aquatic species, as in @fisher2014's application to invasive salmon or @falke2012's model on Great Plains stream fishes.

While most articles focus on a single taxa, 40% of the studies in our sample fit models to more than one taxa ('taxa' defined here as one or more species modelled as one). Of these, 75% fit independent DOMs to multiple species, and 25% fit explicitly multi-species implementations. These multi-species models varied in structure: some use species-specific effects to describe metapopulations by including hundreds of species in a single model [@dorazio2010; @hendershot2020], while others fit models which explicly account for species interactions and estimate conditional occupancy, colonisation, extinction, and detection [@lesmeister2015; @fidino2019]. While they did not fit multi-species models, several other authors fit large numbers of independent models to different species [@peach2019; @otto2012]. Working with large numbers of taxa does raise additional questions, as the level of complexity which can realistically be applied to each individual taxa is likely to be reduced for practicality's sake. With multi-species community frameworks, environmental covariates must be relatively general; and when fitting large numbers of independent models covariate selection processes are likely to be more restricted due to computational limitations.

### Data collection and inputs

DOMs show exceptional diversity in the scales at which they can be implemented. The smallest study area in our sample was less than one kilometre squared, and the largest over one million. Study duration shows similar variation — data collection ran for for less than a month in the shortest study, and for 40 years in the longest, with a median duration of 3.25 years. This reiterates the flexibility of dynamic occupancy models, with explorations of hyper-local patterns of occupancy and analyses of continental-scale distribution using the same underlying model structure. The detection data collected from these surveys came from a variety of detection methods: 69% of articles used human observations, 20% conducted live trapping, 12% used camera traps, and 1% used bioacoustic monitors (@fig-StudyDetails).

It is important to note that the data input requirements for dynamic occupancy models are not as arduous as may be commonly perceived. While it *is* necessary to record multiple observations at individual sites, this does not necessarily require that data be collected according to a strict, preconceived sampling scheme. Post-hoc manipulation of other data such as long-term citizen monitoring programs [@zuckerberg2011; @peach2019], disparate agency modelling programs [@mcgowan2020], or camera trapping data [@davis2018] is feasible with careful consideration. In one example, @riddell2021 used data from as long ago as 1908 by treating grid cells as sites and counting historical surveys within each cell as repeat observations. In a similar vein, all detection data does not necessarily need to come from the same source — detections from multiple methods, with associated variation in detection probabilities, may be incorporated within a single model [@warrier2020; @pitman2017].

Such broadness and flexibility in data inputs is not amenable to a one-size-fits-all definition of occupancy. Authors must carefully consider precisely what they are modelling and address questions on the 'scale' represented by their model [@chave2013]. Drivers of occupancy may differ depending on whether a site is represented by a single point on the landscape or as a grid cell, with the former likely to depend on more local, small scale factors rather than landscape-level trends [@stevens2019]. This is also true for the *temporal* scale of occupancy: whether a site is occupied within a week or within a year is a non-arbitrary distinction representing vastly different conceptions of occupancy. This discussion is particularly pertinent in cases where the selection of season length *is* to some extent arbitrary, as with camera-trap or bioacoustic data where continuous recordings can be broken down into distinct 'seasons' of any length. DOMs are well suited to these data types [@balantic2019], and the proliferation of autonomous survey techniques provides novel opportunities for analysis that is simply not possible with human-collected data. For example, @kleiven2020 and @mölle2022 divide their camera trap records into seasons of just a few days. While this provides exciting insights of occupancy at extremely fine temporal scale, further research is needed on how to determine appropriate season and survey durations with respect to research questions.

### Objectives and applications

Authors have used the DOM in many ways to achieve their research aims. The most frequent objective for studies using DOMs was hypothesis testing, with 50% of authors expressing interest in a specific relationship. 31% were interested in identifying nondescript drivers of occupancy, 30% in estimating models parameters like occupancy themselves, and 29% worked to develop and expand on methods for DOMs. Just 10% of authors expressed interest in making predictions to unsurveyed locations or into the future. The DOMs ability to make predictions has been often underexploited in the existing literature, given its noted potential for forecasting occupancy in non-equilibrium scenarios [@kéry2013; @briscoe2021]. Articles which *do* make predictions provide some of the most directly applicable outputs found in the review sample. As examples, @mcgowan2020 provides projections for a threatened species under multiple putative management scenarios, and @pollentier2021 generates maps of distributions resembling those made with species distribution models (SDMs).

The authors of the studies captured in our sample come from a variety of backgrounds. 86% of articles had at least one author based at an academic institution, 46% had author(s) at government institutions and 25% had author(s) from non-profit organisations. The high proportion of articles with government and NGO participants suggests an applied focus for many users of DOMs. This has important implications: when a model is used to assess a critically endangered species [@carvalho2023], guide public health management of a disease vector [@mores2020], or track rapidly-developing biological invasions [@wood2020], it is imperative that models can be trusted to accurately represent a system. Regardless of the reasons why they turn to the DOM to analyse their data, authors must navigate the model building process.

# Approaches to implementation

Approaches to building any type of model will necessarily depend on the possibilities of the data at hand and on the priorities of the model-builder. This precludes any prescription of the 'best' way to build a model; however, there may still be commonalities in the modelling workflow. The modelling process for both DOMs and SDMs can be divided into a few components. First, based on prior knowledge and ecological theory a suite of covariates with hypothetical relationships with model parameters is assembled. Next, some form of model selection procedure is followed to identify either a single optimal model, or an ensemble of suitable models to be used to make conclusions. Following this, a model's performance should be somehow assessed so that the validity of conclusions can be adequately judged. In this section we examine how DOM users have approaches each of these stages, and make comparisons to common practice in the more extensive SDM literature.

### Model complexity

'Complexity' is a broad term which encompasses many aspects of a model [@merow2014]. Opinions on simple versus complex models can be divided - some advocate for the simplest possible models, arguing that they are most generaliseable; others insist that overly-simple models cannot adequately represent the most important drivers in a system [@evans2013; @lonergan2014]. To account for imperfect detection and describe change in occupancy, DOMs must be somewhat more complex relative to static correlative occupancy models. This added complexity helps mitigate the bias introduced when important elements like imperfect detection are ignored. Within DOMs, however, further complexity is to some degree up to the modeller: they can choose how many covariates to consider for inclusion on the various parameters, and how to represent the nature of the relationship between those covariates and parameters.

The variation in the quality of covariates considered for each model parameter amongst our reviewed articles is shown in @fig-covariates. Notably, many studies expressed some parameters as a constant without including any covariates: of the four standard model parameters initial occupancy has the most articles considering zero covariates (35%) and detection probability the least (19%). A lack of any covariates on the initial occupancy parameter raises some questions. Presumably any taxa will have some amount of non-random variation in how it is distributed across a landscape; by expressing initial occupancy as a constant this heterogeneity is not captured. Omission of factors which drive occupancy can introduce bias into SDMs [@barry2006]. Initial occupancy is itself effectively a static correlative SDM, and the effects of poorly estimating this parameter on predicted occupancy in ensuing seasons is uncertain but unlikely to be favourable.

![Distribution of covariate quantity considered for each model parameter.](Figures/CovParamPlot.jpeg){#fig-covariates}

The types of covariates which were considered for modelling were also wide-ranging, and a summary of their inclusions in articles is presented in @tbl-covariates. The most frequently used covariates described aspects of habitat, with 57% of articles considering these terms for at least one parameter. Data for covariates may be either collected directly, requiring measurement at individual sites, or indirectly via remote sensing — where directly measured covariates may offer more direct insights, indirect measurements are far more easily projected to unsurveyed sites when making predictions [@austin2002]. Some covariates, like biotic interactions, must nearly always be measured at sites, while others such as climate and weather covariates are generally indirectly observed. There is variation in which covariates are most likely to be dynamic and change through time.

::: column-page-inset
```{r covariate table}
#| echo: false
#| message: false
#| label: tbl-covariates
#| tbl-cap: "All covariates considered for inclusion in a study were classified into mutually exclusive categories. For each parameter (initial occupancy, colonisation, extinction, and detection), the percentage of studies including at least one covariate in a given category is presented. We also present the percentage of covariates in each category which are dynamic (change throughout seasons) or require direct observation (e.g. are not remotely sensed). The percentage of covariates in each category for which non-linear representations or interactions with other covariates were considered is given to indicate which were most likely to be included as more complex terms."

library(tidyverse)
library(gt)

covTable <- read_csv("Figures/CovariateTable.csv")

covTable |>
  arrange(Category, -Overall_Proportion) |>
  gt(rowname_col = "Type") |>
  tab_header("Covariate attributes") |>
  tab_row_group(
    label = md("Environmental covariates"),
    rows = Category == "Environmental",
    id = "Env"
  ) |>
  tab_row_group(
    label = md("Other covariates"),
    rows = Category == "Other",
    id = "Other"
  ) |>
  tab_style(
    style = cell_fill(color = "#82AD8E"),
    locations = cells_row_groups(groups = "Env")
  ) |>
  tab_style(
    style = list(
      cell_fill(color = "gray70")
    ),
    locations = cells_row_groups(groups = "Other")
  ) |>
  row_group_order(groups = c("Env", "Other")) |>
  tab_spanner(label = "Articles with covariate on:",
              columns = c("Overall_Proportion", "InitOcc_Proportion",
                          "Colonisation_Proportion", 
                          "Extinction_Proportion",
                          "Detection_Proportion"),
              id = "articles") |>
  tab_spanner(label = "Covariates which are:",
              columns = c(Proportion_Dynamic, Proportion_Observed),
              id = "covariates") |>
  tab_spanner(label = "Represented as:",
                columns = c(Proportion_Polynomial, Proportion_Interact),
                id = "representations") |>
   cols_label(
    Overall_Proportion = "Any parameter",
    InitOcc_Proportion = "Initial Occ.",
    Colonisation_Proportion = "Colonisation",
    Extinction_Proportion = "Extinction",
    Detection_Proportion = "Detection",
    Proportion_Dynamic = "Dynamic",
    Proportion_Observed = "Directly observed",
    Proportion_Polynomial = "Non-linear",
    Proportion_Interact = "Interaction"
  ) |>
  cols_hide(Category) |>
  fmt_percent(decimals = 0) |>
  sub_missing(missing_text = "-")|>
  tab_style(style = cell_fill(color = "lavender"),
            locations = cells_body(columns = Overall_Proportion,
                                   rows = Overall_Proportion == max(Overall_Proportion, na.rm = TRUE))) |>
    tab_style(style = cell_fill(color = "lavender"),
            locations = cells_body(columns = InitOcc_Proportion,
                                   rows = InitOcc_Proportion == max(InitOcc_Proportion, na.rm = TRUE))) |>
    tab_style(style = cell_fill(color = "lavender"),
            locations = cells_body(columns = Colonisation_Proportion,
                                   rows = Colonisation_Proportion == max(Colonisation_Proportion, na.rm = TRUE))) |>
    tab_style(style = cell_fill(color = "lavender"),
            locations = cells_body(columns = Extinction_Proportion,
                                   rows = Extinction_Proportion == max(Extinction_Proportion, na.rm = TRUE))) |>
    tab_style(style = cell_fill(color = "lavender"),
            locations = cells_body(columns = Detection_Proportion,
                                   rows = Detection_Proportion == max(Detection_Proportion, na.rm = TRUE))) |>
    tab_style(style = cell_fill(color = "lavender"),
            locations = cells_body(columns = Proportion_Dynamic,
                                   rows = Proportion_Dynamic == max(Proportion_Dynamic, na.rm = TRUE))) |>
    tab_style(style = cell_fill(color = "lavender"),
            locations = cells_body(columns = Proportion_Observed,
                                   rows = Proportion_Observed == max(Proportion_Observed, na.rm = TRUE))) |>
    tab_style(style = cell_fill(color = "lavender"),
            locations = cells_body(columns = Proportion_Polynomial,
                                   rows = Proportion_Polynomial == max(Proportion_Polynomial, na.rm = TRUE))) |>
    tab_style(style = cell_fill(color = "lavender"),
            locations = cells_body(columns = Proportion_Interact,
                                   rows = Proportion_Interact == max(Proportion_Interact, na.rm = TRUE))) |>
  as_raw_html()
  
```
:::

For the vast majority of covariates authors considered only linear relationships with model parameters. Polynomial responses are rare — even in the categories where they are most frequently used, the rate of consideration for non-linear responses does not exceed 16%. This is a notable departure from SDMs; while GLM-based methods with linear responses are used, many common methods used to fit SDMs like MAXENT or boosted regression trees typically permit flexibility in response curves between covariates and parameters [@merow2013; @elith2008]. Non-linear relationships are the norm, not the exception in nature, and in many cases a linear response will not adequately capture a covariate's influence on model parameters [@austin2002]. Interactions between covariates were also rarely incorporate in our sample, and their rate of inclusion does not exceed 34% for any category. While they should not necessarily be used liberally, where these interactions exist their exclusion can influence model performance [@guisan2006].

Any model must balance simplicity and realism, but it is important that the ecological relationships quantitatively expressed in a model be grounded in ecological theory and accurately represent the modeller's hypothesised response [@austin2002; @austin2007]. Complexity in the quantity and nature of covariate responses is also controlled during model selection, but these procedures can only work with the information provided to them. Adequately considering the plausible drivers of occupancy and detection by identifying quality candidate covariates representing those drivers is an important step in developing robust models that appropriately account for heterogeneity in these parameters.

### Covariate selection

Variation in approaches to modelling is particularly apparent in the model selection process, where there is little consensus on how to determine which covariates to include in final models (@fig-selection). In the reviewed frequentist implementations, a range of approaches have been used for this purpose including comparison suites of candidate models defined *a priori* and various stepwise selection protocols. Bayesian implementations were far less likely to use model selection procedures — 70% of these fit only a single model defined *a priori,* relative to 10% amongst the frequentist models.

![Frequency of use for model selection methods. 'Single model' indicates no model selection occurred, 'candidate suite' includes studies which compared a predefined set of models, articles with 'procedural selection' fit parameters one-by-one, 'exhaustive selection' fit all possible combinations of models, and 'simple precursor' describes where results of a less-complex model were used to inform covariate choice.](Figures/SelectionFigure.jpeg){#fig-selection}

Model selection is a particularly challenging aspect of fitting DOMs, with substantial uncertainties in the best ways to conduct the process. Limited research has been conducted on the topic, but what has been done has indicated that choices in this process can influence the quality of model outputs [@morin2020]. This is reflected in research from outside the DOM literature, where stepwise protocols have been found to be unreliable [@olden2000]. However, others have found that different model selection methods can end up arriving at roughly the same answer [@maggini2006]. Model selection can be particularly difficult for DOMs given the increased complexity of the underlying model structure, which will often preclude exhaustive selection from amongst all possibilities.

Bayesian model selection is an effectively distinct question in DOMs as the framework is not well suited to the more conventional model selection methods. @hooten2015 provides a guide to some of the possibilities for optimising Bayesian models, including the use of regularisation priors.

### Model validation

Regardless of whether a model was implemented under the Bayesian or frequentist frameworks, evaluation of model fit or performance was rare. Only 8% of articles directly addressed either aspect of modelling, be it via goodness-of-fit tests or validation with either internal or external data. This is a striking departure from the SDM literature, where roughly half of studies sufficiently assess their models performance [@araújo2019]. While the appropriate method of model evaluation may depend on data availability and research objectives, assessing models by some method is always important to ensure reliability of model outputs [@araújo2005; @guisan2005]. Most models in our sample conduct model selection using AIC as a scoring criteria, and often using model averages. While these approaches provide *relative* models of fit, they cannot be considered evaluation themselves - as @mackenzie2004 write, "the selection of a 'best' model(s) does not guarantee the selection of a "good" model.

The first goodness-of-fit (GOF) test for occupancy model was given in @mackenzie2004, implemented via a parametric bootstrap. There is no GOF test available for DOM, however, common packages including 'AICcModAvg' and 'unmarked' offer parametric bootstraps derived from @mackenzie2004's test which have been used by some authors in our sample. While these tests may not suit Bayesian implementations, @broms2016 discusses possibilities for model evaluation in that context - while their article focuses on single-season multi-species occupancy models, extensions of their approach may suit the dynamic multi-season model as well.

All aspects of modelling varied with the stated objectives of articles (@tbl-objectives). Those focussed on making predictions and identifying drivers of occupancy were more likely to consider a larger number of covariates and represented covariates in more complex ways by considering non-linear responses and interactions between covariates. Articles with objectives involving methods development considered fewer covariates and were less likely to use these more complex formulations.

<div>

```{r Objectives table}
#| echo: false
#| message: false
#| label: tbl-objectives
#| tbl-cap: "Implementation of models by study objective. Models were assessed based on the number of covariates considered, the inclusion of non-linear responses and interactions between covaraites, the manner of model selection, and whether or not they objectively evaluated model performance."

objTable <- read_csv("Figures/ObjectiveTable.csv")

objTable |>
  mutate(Objective = fct(Objective,
                         levels = c("Hypothesis", "Drivers", "Parameters",
                                    "Methods", "Predict", "Any"))) |>
  arrange(Objective) |>
  mutate(Objective = case_when(Objective == "Hypothesis" ~ "Testing hypotheses",
                               Objective == "Drivers" ~ "Identifying drivers",
                               Objective == "Predict" ~ "Making predictions",
                               Objective == "Methods" ~ "Developing methods",
                               Objective == "Parameters" ~ "Estimating parameters",
                               Objective == "Any" ~ "Any objective")) |>
  gt(rowname_col = "Objective") |>
  tab_spanner(label = "Articles",
              columns = c("Articles", "ArticlesProp"),
              id = "articles") |>
  tab_spanner(label = "Percent which have:",
              columns = c("ProbPoly", "ProbInt",
                          "ProbEval", "ProbSelect"),
              id = "percents") |>
  cols_label(Articles = "n", ArticlesProp = "%",
             MedianCovs = "Median covariates considered",
             ProbPoly = "Non-linear responses",
             ProbInt = "Covariate interactions",
             ProbSelect = "Model selection",
             ProbEval = "Model evaluation / goodness of fit") |>
  fmt_percent(columns = c(ArticlesProp, 
                          ProbPoly, ProbInt, 
                          ProbEval, ProbSelect),
              decimals = 0) |>
  tab_style(style = list(cell_fill(color = "gray80"),
                         cell_text(style = "italic")),
            locations = cells_body(rows = Objective == "Any objective")) |>
  tab_style(style = cell_fill(color = "lavender"),
            locations = cells_body(columns = MedianCovs,
                                   rows = MedianCovs == max(MedianCovs, na.rm = TRUE))) |>
  tab_style(style = cell_fill(color = "lavender"),
            locations = cells_body(columns = ProbPoly,
                                   rows = ProbPoly == max(ProbPoly, na.rm = TRUE))) |>
  tab_style(style = cell_fill(color = "lavender"),
            locations = cells_body(columns = ProbInt,
                                   rows = ProbInt == max(ProbInt, na.rm = TRUE))) |>
  tab_style(style = cell_fill(color = "lavender"),
            locations = cells_body(columns = ProbEval,
                                   rows = ProbEval == max(ProbEval, na.rm = TRUE))) |>
  tab_style(style = cell_fill(color = "lavender"),
            locations = cells_body(columns = ProbSelect,
                                   rows = ProbSelect == max(ProbSelect, na.rm = TRUE))) |>
  as_raw_html()
```

</div>

# Conclusions and key considerations

Our review highlights the dynamic occupancy model's exceptional flexibility and suitability to addressing a range of ecological questions. The DOM may be a more achievable option than many think with feasible options to incorporate much existing presence/absence data from a variety of sources. Fertile areas for future research remain, with methods and guidance for making predictions and for modelling autonomous detection data from camera-traps and acoustic monitors particularly promising opportunities. In light of this potential and the DOMs status as a popular tool for applied ecology, it is increasingly important that best-practice standards be established for building these models. Major questions remain on fundamental questions in model building — there is need for further research on the appropriate levels of complexity for DOMs in various scenarios, on the methods for selecting models from amongst candidates, and on the best ways to evaluate the quality of the models chosen. In these areas, DOMs lag well behind SDMs where these standards have been more seriously considered [@araújo2006; @araújo2019; @zurell2020]. Given the parallels between these model classes, we may be able to extrapolate some lessons from SDMs to support building better DOMs. In light of these uncertainties, and based upon existing research on SDMs, we discuss some key considerations for authors seeking to use DOMs in their work:

I.  **Are key drivers of occupancy and detection incorporated?** While it is effectively impossible to *fully* describe heterogeneity across a landscape, authors should make their best efforts to capture the drivers of occupancy and detection most likely to influence their study species. This is true even when another covariate is of principal interest to investigators — failure to include other major determinants of occupancy is likely to bias parameter estimates. One place where this is of particular importance is in determining drivers of detection, which is not only subject to observational conditions but also ecological determinants which may cause the species to spend more time at a location and thus be more frequently available for detection.

II. **Do covariates relationships reflect ecological complexity?** Many ecological relationships are non-linear and may require polynomial terms to be accurately represented. This is particularly true at large spatial scales where a larger portion of a species ecological niche is represented in surveyed data. Authors should question whether a linear term is sufficient to capture hypothetical relationships in their study systems, and consider representing species responses as polynomials terms where appropriate. Interactions between covariates should also be explored where a plausible ecological relationship between factors exists.

III. **How should model evaluation be conducted?** Regardless of why a model is used, it is important to assess its quality and its ability to support the conclusions drawn from it. While more research is needed on the most robust ways to assess models, existing methods should be used and reported in published studies. Dependent on data availability and model objectives, this can be achieved through bootstrapped goodness-of-fit tests or metrics of predictive performance on reserved data. This is an important step in establishing best-practices for the field, and should realistically be conducted in some form for the vast majority of studies.

As previously stated, DOMs and their outputs are important — in a biodiversity and conservation context where quantitative representations of complex natural systems are used to guide policy and decision making, it is necessary to ensure models can be trusted. We hope that this review can open a broader discussion on how to best approach dynamic occupancy modelling as a first step towards establishing best practices in the discipline.
