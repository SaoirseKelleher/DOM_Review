---
title: "Twenty years of dynamic occupancy models: a review of applications and a look towards the future"
date: today

authors:
  - name: Saoirse Kelleher
    affiliation: University of Melbourne
    email: saoirse.kelleher@student.unimelb.edu.au
    orcid: 0000-0002-4614-5753
    corresponding: true
  - name: Natalie Briscoe
    affiliation: University of Melbourne
  - name: Gurutzeta Guillera-Arroita
    affiliation: Pyrenean Institute of Ecology, Spanish National Research Council
  - name: Jane Elith
    affiliation: University of Melbourne
    
abstract: | 
  Describing patterns of species occupancy across landscapes and throughout time is a key objective of much ecological research. Nonetheless, reliably estimating occupancy can be a challenge, particularly when common issues such as imperfect detection and shifting distributions are at play. The dynamic, multi-season occupancy model (DOM) offers a framework for occupancy estimation which explicitly accounts for observation error, while also incorporating additional mechanistic process by explicitly estimating colonisation and extinction rates. In the two decades since its introduction, the DOM has become a popular tool for describing patterns in occupancy, exploring the environmental drivers of species occurence, and, more recently, for predicting species occupancy to new locations and to future conditions.
  
  In this review we examine how ecologists have applied the DOM in its first two decades of use. Based on a sample of articles fitting DOMs to field ecological data, we explore the systems in which these models have been used, how data were collected for them, and how authors have built their models to achieve their objectives. Our findings indicate that the DOM is an particularly flexible tool readily applied to a range of diverse taxa from around the globe, capable of being used to estimate occupancy at study sites ranging from local to continental scales over time periods from months to decades. The DOM framework is also amenable to extension, further broadening their utility to address a wide range of ecological questions.
  
  A key aim of this review is to explore how users of DOMs have incorporated covariates into their models to describe variation in occupancy through space and time. Broadly speaking, model complexity in DOMs tends to be low, with relatively few covariates considered for inclusion and most relationships represented as simple linear terms. Considerable variation also exists in the procedures used for covariate selection, and limited research has been conducted on how these choices may influence model performance and inference. Furthermore, only a fraction of articles appear to evaluate models (either by goodness-of-fit testing or prediction validation). Likewise, little guidance exists on how to approach this task in DOMs. These uncertainties in the modelling process should be key priorities for future research on DOMs given their increasing use in applied ecological research.
  
bibliography: references.bib
csl: apa.csl
---

# Introduction

The description of patterns of species occupancy across landscapes has been a long-standing subject of ecological research [@humboldt1849]. An understanding of where a species exists, which factors lead to its presence, and how its distribution may be changing can be applied in many ways. Descriptions of how widespread a species is and where it occurs are the foundation of monitoring programs and important for assessing conservation status, and identifying potential drivers of occurrence can help inform potential management actions. Robust knowledge of the occupancy patterns of a species also helps us to predict where a species is most likely to occur, both under present conditions and in hypothetical future scenarios.

While occupancy is a useful concept, it is also a challenging quantity to describe, measure, and estimate. The need to understand and describe species occupancy has led to the development of several popular modelling approaches, including stochastic patch occupancy models [@gutiérrez-arellano2024] commonly used to study meta-population dynamics, and species distribution models [SDMs, @franklin2010] widely used to explore species occurrence at larger scales. However, several factors can make occupancy a difficult quantity to estimate. For instance, simple presence/absence data of species observations can be biased when species are detected imperfectly, as is the case with most wildlife field data. Generally speaking, it is impossible to determine whether a location is truly unoccupied or whether the species occurs but was not detected by the observer [@lahoz-monfort2014; @gu2004]. Despite the ubiquity of imperfect detection in data collection, many models fit to presence/absence data make no adjustment for this source of bias [@kellner2014]. Another challenge for modelling occupancy is the difficulty in describing populations under non-equilibrium conditions, where a species occurrence pattern and relationship to its environment is in flux [@dormann2007; @elith2010]. These conditions are prominent during biological invasions and climate change driven range shifts, both conservation priorities and increasingly common scenarios in the Anthropocene [@bertelsmeier2013; @lenoir2015].

The site occupancy models first introduced by @mackenzie2002 set the foundation for a powerful framework for modelling presence/absence data while accounting for each of these challenges [@guillera-arroita2017]. Drawing on principles from the mark-recapture literature, occupancy models use multiple resurveys of sites to estimate detection probabilities and correct for bias in estimates of site occupancy. Originally a static model, @mackenzie2003 extended this model for use in multiple time-steps by explicitly describing the process of changing occupancy via colonisation and extinction, relaxing assumptions of equilibrium and allowing description of patterns of site occupancy through time. This dynamic occupancy model (DOM) balances complexity and feasibility, explicitly describing the key processes which drive occupancy dynamics while requiring reasonably simple-to-collect presence absence/data instead of the detailed demographic data required by more process-explicit models [@briscoe2019]. These features make the DOM an important tool, with uses for tasks including hypothesis testing of relationships between occupancy and the environment, explorations of the key drivers of occupancy, and even prediction of occupancy under future conditions [@kéry2013; @briscoe2021].

In this review we examine how dynamic occupancy models have been used by ecologists in the two decades since their inception. Following an introduction to the model's form and assumptions, we present the results of a systematic review exploring how researchers have applied the DOM to ecological data, with emphasis on how they collected their data, selected covariates, and evaluated their models. Based on these results we highlight the DOM's flexibility as a tool for understanding species occurrence, examine approaches to the model building process, and outline key priorities for future research involving this model class.

### Dynamic occupancy model form and assumptions

The DOM structure encompasses two processes: the ecological process of site occupancy dynamics describing the presence or absence of a species at a site at any point in time, and the observational process of detection describing whether a species is observed at a site where it is present (@fig-modelform). Sites exist in either an occupied or unoccupied state. In the first time step, occupancy state at each site is determined by the probability of initial occupancy. In following time steps, occupancy state can change according to a Markovian process where occupancy is predicated on the site's state in the prior time-step and the probabilities of colonisation and local extinction. In the observation component of the DOM, the model explicitly accounts for imperfect detection. At occupied sites, the detection probability describes whether or not the species is observed during a survey; under the DOM's original parameterisation, it is assumed that false-positive detections at unoccupied sites never occur.

![The form of the dynamic occupancy model as described by @mackenzie2003. The ecological process submodel describes changes in occupancy over time, where occupancy in the first season is given by the probability of initial occupancy and occupancy in ensuing seasons is governed by colonisation and extinction probabilities. The observational process submodel describes detectability, where the probability of detecting a species given that a site is occupied is given by the detection probability. At sites which are truly unoccupied, it is assumed that the species is never detected (i.e., no false positives).](Figures/ModelForm.png){#fig-modelform}

To disentangle the ecological and observational processes the DOM requires a hierarchical sampling design as depicted in @fig-surveys. Under this design, observations at a site occur during distinct, time-bound seasons within which it is assumed site occupancy does not change (that is, sites are closed to changes in occupancy). In each season multiple observations are conducted, permitting estimation of the probability of detection conditional on occupancy. Most frequently these repeat observations are collected by revisiting the site on separate occasions, although they can also be attained by alternative means: examples include conducting surveys at multiple locations within a site, using multiple observers during a survey, or recording the time elapsed until a detection is recorded [@guillera-arroita2017]. It is important to note that it is not necessary for the same number of observations to occur in each year or for each site, and that the DOM accommodates for missing data; this allows for considerably greater flexibility in data inputs.

![The sampling design of the standard dynamic occupancy model. During seasons, also called primary occasions, sites are considered closed to changes in true occupancy state; occupancy state may only change between seasons. Within each season, multiple observations ('secondary occasions') are conducted to record the observed presence or absence of the species at each site. These multiple observations may be recorded in many ways: sites can be revisited multiple times within a season, surveys can be conducted at multiple points within a larger site, multiple observers can conduct surveys contemporaneously, or the time elapsed prior to a detection occurring can be recorded. Note that it is not necessary for each site or season to have the same number of observations, and that missing data can be accommodated.](Figures/SurveyDesign.png){#fig-surveys fig-align="center"}

DOMs make a number of key assumptions requiring careful consideration by model users, which we outline here as our review interrogates related aspects of model building.

I.  **False positive detections do not occur**. While this assumption can be safely met in many studies, it is not necessarily guaranteed when working with more cryptic species or less reliable survey methods. @mcclintock2010 and @miller2015 comment on the bias induced when false positives occur and are not accounted for, highlighting the need for authors to consider how certain their detections truly are. Significantly, even genuine detections of a species can be considered 'false positives' when they do not represent the intended definition of occupancy, such as detections of transient individuals when the intent is to estimate breeding occupancy [@berigan2019]. Where this assumption can not reasonably met, model extensions designed to account for false positive error should be considered.

II. **Sites are closed to occupancy between seasons.** This requirement, best known as the 'closure assumption,' has also been subject to considerable discussion around the bias which is introduced when it is violated [@rota2009; @otto2013]. Closure is dependent not only on the life history of the species, but also on the definition of occupancy used by researchers — short seasons may represent dynamics more representative of species 'use,' and @valente2017 discuss the difficultly in distinguishing between temporary emigration and local extinction. Model extensions to relax the closure assumption have been developed, including @kendall2013's approach using staggered arrival and departure periods between sites. A more pertinent approach for most studies, however, is careful consideration of ecologically relevant seasons corresponding to an appropriate definition of occupancy.

III. **Heterogeneity in occupancy and detection is accounted for.** As with any approach for modelling species occurrence, it is assumed that DOMs appropriately capture variation in occupancy patterns and species detectability across the study system. Generally, this is achieved by allowing model parameters to vary with respect to covariates representing the environmental factors which may be expected to influence these parameters. An important element of this assumption is that the likelihood of detection of a species depends not only on the observability of the species, but also on factors like habitat suitability which influence species abundance and activity [@guillera-arroita2017]. While no model will fully account for the complexity inherent in patterns of species occupancy and detection, failure to capture key drivers is likely to introduce bias and confound inference made from model estimates. Compared to the first two assumptions mentioned, this aspect of DOMs has been less thoroughly discussed and comparatively little is known about how this latent heterogeneity can influence model performance.

Since its original description in @mackenzie2003, the DOM has been further developed with numerous model extensions and alternative formulations including implementations accounting for false positives [@royle2006; @miller2011; @miller2015], multiple states beyond occupied and unoccupied [@nichols2007], and jointly estimated multi-species models [@dorazio2010]. For a comprehensive discussion of the most common extensions and their applications see @bailey2014 and @guillera-arroita2017, as well as @devarajan2020 for a more detailed review of multi-species occupancy models.

# Systematic review methods

To assess how DOMs have been applied in the years since their introduction we gathered a representative sample of articles fitting them to field ecological data. A pool of candidate articles was generated using two queries on Web of Science. The first of these included all articles from 2004-2023 which cite @mackenzie2003. To capture any additiona relevant articles which did not directly cite @mackenzie2003, a second query was generated searching articles in the same time-span matching the terms "*dynamic occupancy model\**", "*multi-season occupancy model\**", or "*occupancy dynamic\**"; articles including each of "*occupancy*", "*colonization*", "*extinction/persistence*", and "*detection*"; and articles with the term "*occupancy*" located near "*dynamic*" in the title, key terms, or abstract. As we were interested in how DOMs use has changed through time, we divided all articles across four-year-long strata spanning 2004-2007, 2008-2011, 2012-2015, 2016-2019, and 2020-2024. From each of these strata we randomly selected 20 articles for inclusion in the review. Articles which did not meet inclusion criteria were replaced from within their own strata.

As our review focuses only on applications of the dynamic multi-season occupancy model of @mackenzie2003 and its extensions, we included articles which fit a model meeting the following criteria: i) uses non-simulated, field-collected, presence-absence data; ii) relies on data from multiple sites which can exist in at least two states, including an occupied and unoccupied state; iii) has multiple seasons, between which sites may change states conditional on the prior season's occupancy state and transition probabilities such as colonisation and extinction; and iv) contains at least one parameter describing the detection process.

For each article we recorded key details on authorship, research objectives, study taxa and system, survey methods, and modelling approach. To examine the reasons why authors used DOMs, we allocated each article to one or more category of objective based on the study's stated aims. The possible categories were *Observing trends*, where authors express interest in estimates of site occupancy, colonisation, extinction, or detection probabilities; *Testing relationships*, where authors explore specific predefined hypotheses of relationships between covariates and model parameters; *Identifying drivers*, where authors attempt to find which covariates influence model parameters; *Predicting temporally*, where authors predict site occupancy under future conditions, *Predicting spatially*, where authors predict site occupancy to unsurveyed locations, and *Developing methods*, where authors introduce, test, or demonstrate aspects of dynamic occupancy models.

We recorded details on the type of organisms (bird, mammal, etc.) modelled in each article, and the means by which multiple species were modelled where applicable. Taxa were denoted as threatened either when they are listed on the IUCN Red List of Species or when authors indicate that they are threatened. This deference to authors' representation of conservation status was made to account for sub-species which lack listings or species which are of more local concern. Study locality and size was documented; the size of the study area being defined as the intended area of inference which contained all sites — this was measured to the order of magnitude to account for uncertainty in reporting.

We were particularly interested in how authors navigated the modelling process, from covariate selection through model evaluation. To this end, we recorded all covariates considered in each study regardless of whether they were or were not included in final models. Key traits of each covariate were recorded including their general category, whether they were directly observed or remotely sensed, whether they were static or varied between seasons, and how they were presented in the model (as a linear term, a polynomial term, or as part of an interaction with another covariate [@james2021]). Model selection procedures were also sorted into non-exclusive categories including *A priori*, where only one model was considered; *candidate suite*, where a predefined set of models was considered; *sequential,* where covariates were selected parameter-by-parameter; and *simple precursors*, where selection was preceded by another simpler model implementation. Finally, for each model we documented whether goodness-of-fit was tested and reported, as well as whether model performance was assessed by validation with either in or out-of-sample data. For the full spreadsheet of data collected and further details on categorisation, see supplementary material.

# Applications of dynamic occupancy models

A total of 92 articles were included for this review. Based on the acceptance rates within each strata and quantity of unprocessed articles, an estimated 496 of the 1152 unreviewed articles in our sample would have met inclusion criteria (@fig-coverage).

![Bars indicate the 92 articles included in our review as a proportion of the estimated number of published articles fitting DOMs, based on the qualification rate for articles in each strata. The proportion of articles included from each strata were as follows: 12.5% from 2005-2008; 24.4% from 2008-2011; 42.6% from 2012-2015; 35.1% from 2016-2019; and 57.1% from 2020-2023.](Figures/CoveragePlot.jpeg){#fig-coverage}

Articles included in our review demonstrate considerable diversity in scope, scale, and objectives. A selection of key attributes of these studies is presented in @fig-StudyDetails, and we provide notable examples of DOMs throughout this section to highlight how some this variation appears in practice. Study systems included in our sample are globally distributed; while a majority use data collected in the United States of America, representatives are included from all geographic realms and an exceptional diversity of ecosystems. A particularly notable aspect of these study areas is their variation in size, which ranges from the hyper-local to the continental scale. The smallest study locality included in our sample studied insect occurrence in a rainforest plot less than one square kilometre, while the largest analysis modelled avian range shifts across the entire eastern half of the United States [@basset2023; @clement2019].

The temporal scale of studies shows similar variability. The duration between first and last survey ranging from under one month to forty years, with a median of 6 years. More meaningful for model interpretation, however, is the duration of the primary occasion, as this is presumed to be the temporal scale at which changes in occupancy are observed. Most applications describe the primary occasion as a year, although some studies divide years into multiple primary occasions to describe seasonal variation in occupancy. In the most extreme cases the primary occasion may be as brief as a week, capturing much finer scale changes in occupancy. These shortened-season occupancy models are most common with camera trapping or acoustic monitoring data, which can be arbitrarily divided into primary and secondary sampling occasions. This is seen in @kleiven2020's study of rodent and mustelid interactions using camera trap data, where the primary occasions are less than one week in length. On the other end of the spectrum, some studies modelled primary occasions which were decades apart and represented generational changes in occupancy. This is illustrated in @couturier2023's study on long-term otter recovery in France, which used data from two primary occasions: one in 2003 and one in 2012.

DOMs have been used to study a variety of different species, though the majority of studies have been conducted on data for vertebrate taxa. They have been less frequently applied to non-animal organisms, perhaps due to a reduced emphasis on imperfect detection outside of the wildlife modelling community. However, there are exceptions — @belinchón2017 fits a DOM to lichen data, and @cook2022 uses them to model the spread of chronic wasting disease. The latter's application to disease dynamics is not unique, and DOMs have been touted as a valuable tool for modelling disease dynamics. @mores2020 and @padilla-torres2013 have each used DOMs to model mosquito dynamics as a human disease vector, and @bailey2014 discusses the concept of applying the DOM to the spread of chytrid fungus in amphibian habitats. The vast majority of applications have been fit for terrestrial species, though there have been a limited number of studies on aquatic systems, including @fisher2014's application to invasive salmon, @falke2012's on Great Plains stream fishes, and @pendleton2022's on whale occupancy dynamics.

While most articles in our sample fit a model to a single species, 41 fit models to multiple species either as independent models or explicitly multi-species implementations. The multi-species models use various extensions of the conventional DOM, including hierarchical models which fit hundreds of species in a single implementation with species-level effects[@dorazio2010; @hendershot2020], as well as explicit interaction models which estimate conditional occupancy, colonisation, extinction, and detection probabilities [@lesmeister2015; @fidino2019]. While they did not fit multi-species models, several other authors fit large numbers of independent models to different species [@peach2019; @otto2012]. Working with large numbers of taxa does raise additional challenges, as the level of complexity which can realistically be considered for each individual taxon is likely to be reduced for the sake of practicality.

![A) Study areas: Data for a majority of studies were collected from study locations in the United States. The size of study areas was log-normally distributed, with the median study area falling between 1000 and 10000 square kilometres. \n B) Study taxa: Most species modelled in our sample were terrestrial vertebrates including birds, mammals, or herptiles. 55 articles fit models to only a single taxa, 30 fit independent models to multiple taxa, and 11 fit multi-species models with explicit interactions between taxa. \n C) Survey methods: Approaches to data collected were varied and included conventional surveys like point counts and transects as well as more modern methods like camera traps and acoustic monitors. 13 articles incorporated data from citizen science projects. Project scale was also variable, with the median study running for 6 years and covering 101 sites.](Figures/ReviewBox.png){#fig-StudyDetails}

The presence/absence data required for DOMs has come from a breadth of different sources and detection methods. In our sample 79% of articles used human observational data, 9% used live-trapping methods, and 14% used detections from camera traps. Several articles also use citizen-science data to build detection histories, including @zuckerberg2011's model using bird-feeder data and @warrier2020's using citizen reports of tiger signs. Using citizen-science data may require additional consideration of assumptions (particularly false-positives), as discussed in greater detail by @cruickshank2019. Within these broad categories of detection method there is additional diversity, with several studies using unique survey methods determining the presence of a species at a location. For example, in the only application of a DOM for a marine species in our sample, @pendleton2022 uses aerial transects broken up into grid cells to observe whale occupancy; and @marescot2020's fits a unique 'multi-species' model treating poachers and using ranger reports to create detection histories.

Notably, many of these studies use data which were not originally collected in a robust design framework for occupancy modelling. In these articles, authors formatted their data into a hierarchical format post-hoc using a variety of methods. Some defined primary seasons as a discrete time interval, treating all surveys occurring within the season as secondary occasions; others defined sites as larger grid cells, treating any survey falling within the grid as a spatial replicate. These manipulations permit authors to use data which far predate the DOM, with one study using surveys conducted by Joseph Grinnell in 1908 to model century-long changes in occupancy [@riddell2021].

Additionally, not all articles rely on a single source of detection data - some integrate multiple sources of data to maximise sample size, combining data from camera traps, sign surveys, and citizen science reports. These integrated detection method models do require additional care and consideration; users must ensure that different detection methods represent comparable spatial and temporal scales, and that any variation in perceptibility between detection methods is accounted for [@warrier2020; @pitman2017]. A special case exists when different detection methods are used where one has the potential for false positive detections; e.g., where less-certain citizen science detections are combined with certain detections from field surveys. In this context, the certain detections are used to help account for false-positive detection probability, as in @miller2011's study integrating GPS collars and hunter reports to estimate wolf occupancy in Montana.

The flexibility in the data used for DOMs, including the model structure and the scale of observations, is not amenable to a one-size-fits-all definition of occupancy. Users of DOMs must carefully consider precisely what they are modelling and address questions on the scale represented by their model [@chave2013]. Intepretation and drivers of occupancy may differ depending on whether a site is represented by a single point on the landscape or as a grid cell, with the former likely to depend on more local, small scale factors rather than landscape-level trends [@stevens2019]. This is also true for the temporal scale of occupancy: whether a site is occupied within a week or within a year leads to vastly different conceptions of occupancy. This idea is particularly relevant in cases where the selection of season length *is* to some extent arbitrary, as with camera-trap or bioacoustic data where continuous recordings can be broken down into distinct 'seasons' of any length. DOMs are well suited to these data types [@balantic2019], and the proliferation of autonomous survey techniques provides novel opportunities for analysis that is simply not possible with human-collected data. For example, @kleiven2020 and @mölle2022 divide their camera trap records into seasons of just a few days. While this provides interesting insights of occupancy at extremely fine temporal scale, further research may be needed on how to determine appropriate season and survey durations with respect to research questions and the closure assumption.

# Practices in implementation and model building

Building dynamic occupancy models can be a challenging process requiring careful consideration of which environmental factors to incorporate to adequately represent occupancy and detection in complex natural systems. In this review, we have recorded all covariates considered for each model in our sample. These are summarised in a taxonomy presented in @tbl-covariates, which states the proportion of articles considering each type of covariate in their models, the means by which that covariate data are collected, and how covariates responses are represented in DOMs. We further categorise these covariates into two groups: environmental covariates, which represent plausible ecological correlates of parameters; and structural covariates, representing aspects of model form and observation functionally distinct from the environment. Our findings indicate that users of DOMs have incorporated an exceptionally wide diversity of covariates in their models — while the most common varieties of covariates include aspects of habitat and land cover, a range of other unique factors were considered by authors in our sample. Many models incorporate covariates representing aspects of site geometry and connectivity (37% of articles), adding spatial components to these DOMs which bear similarities to related stochastic patch occupancy models. Notable examples of these spatially-explicit models include @mortelliti2007's model fit to rodent data in patchy landscapes and @risk2011's hybrid DOM/incidence function model used to explore meta-population dynamics of rails. Several studies also include biotic interactions with other species as covariates, particularly those which describe taxa threatened by invasive species. Examples include models with barred owl presence as a covariate on spotted owl occupancy and models with bullfrog covariates on native amphibian occupancy, each of which effectively incorporate species interactions without fitting explicitly multi-species models [@mangan2019; @rowe2019].

::: column-page-inset
```{r covariate table}
#| echo: false
#| message: false
#| label: tbl-covariates
#| tbl-cap: "All covariates considered for inclusion in a study were classified into mutually exclusive categories. We calculate the percentage of articles which include at least one covariate of a given category on any parameter, Initial Occupancy (&psi;1), Occupancy (&psi;), Colonisation (&gamma;), Extinction(&epsilon;), and Detection (&rho;). We also present the percentage of all implementations of each covariate category which are dynamic (varying through seasons) and directly observed, as well as the percentage of articles which model each category of covariate as a non-linear relationship or as part of an interaction with another covariate."

library(tidyverse)
library(gt)

covTable <- read_csv("Figures/CovariateTable.csv")

covTable |>
  mutate(Summary = case_when(Covariate %in% c("Environmental", "Structural", "Overall") ~ TRUE,
                             .default = FALSE)) |>
  arrange(Category, Summary, -Prop_Any) |>
  gt(rowname_col = "Covariate", groupname_col = "Category") |>
  tab_options(
    row_group.as_column = TRUE
  ) |>
  tab_row_group(
    label = md("Environmental covariates"),
    rows = Category == "E",
    id = "Env"
  ) |>
  tab_row_group(
    label = md("Structural covariates"),
    rows = Category == "S",
    id = "Struct"
  ) |>
  tab_row_group(
    label = md("All covariates"),
    rows = Category == "O",
    id = "All"
  ) |>
  tab_style(
    style = cell_fill(color = "aquamarine4"),
    locations = cells_row_groups(groups = "Env")
  ) |>
  tab_style(
    style = list(
      cell_fill(color = "plum4")
    ),
    locations = cells_row_groups(groups = "Struct")
  ) |>
  tab_style(
    style = list(
      cell_fill(color = "gray60")
    ),
    locations = cells_row_groups(groups = "All")
  ) |>
  row_group_order(groups = c("Env", "Struct", "All")) |>
  tab_spanner(label = "Percentage of articles with covariate on parameters:",
              columns = c("Prop_Any", "Initial occupancy", "Occupancy",
                          "Colonisation", "Extinction_Persistence",
                          "Detection"),
              id = "inclusions") |>
  tab_spanner(label = "Percentage which are:",
              columns = c(Prop_Dynamic, Prop_Direct),
              id = "covariates") |>
  tab_spanner(label = "Articles representing this covariate with:",
              columns = c(Prop_Nonlinear, Prop_Interact),
              id = "representations") |>
   cols_label(
    Prop_Any = "Any",
    `Initial occupancy` = html("&psi;1"),
    Occupancy = html("&psi;"),
    Colonisation = html("&gamma;"),
    Extinction_Persistence = html("&epsilon;"),
    Detection = html("&rho;"),
    Prop_Dynamic = "Dynamic",
    Prop_Direct = "Directly observed",
    Prop_Nonlinear = "Non-linear relationships",
    Prop_Interact = "Interactions between covariates"
  ) |>
  text_case_match(
    "Environmental" ~ html("<b>Any Environmental</b>"),
    "HABT" ~ html("<b>Habitat </b>\n<i>Aspects of habitat and land cover</i>"),
    "PHEN" ~ html("<b>Phenology</b>\n<i>Time-varying elements distinct from sampling occasions</i>"),
    "SPAT" ~ html("<b>Spatial</b>\n<i>Site geometry, connectivity, or other spatial elements</i>"),
    "OTHER-E" ~ html("<b>Other environmental</b>\n<i>Other environmental covariate not otherwise listed</i>"),
    "TOPO" ~ html("<b>Topography</b>\n<i>Elements of landscape topography, including hydrology</i>"),
    "CLWE" ~ html("<b>Climate/Weather</b>\n<i>Climate, weather, and natural disasters</i>"),
    "ANTH" ~ html("<b>Anthropogenic</b>\n<i>Relations to human activity</i>"),
    "BIOT" ~ html("<b>Biotic interaction</b>\n<i>Interactions with other (non-plant) species</i>"),
    "Structural" ~ html("<b>Any Structural</b>"),
    "SEAS" ~ html("<b>Primary occasion</b>\n<i>Effect of the primary occasion</i>"),
    "OBSE" ~ html("<b>Observation</b>\n<i>Details on the observation process</i>"),
    "SURV" ~ html("<b>Secondary occasion</b>\n<i>Effect of the secondary occasion</i>"),
    "SPEC" ~ html("<b>Species effect</b>\n<i>Species-level effects</i>"),
    "SITE" ~ html("<b>Site effect</b>\n<i>Site-level effects</i>"),
    "OTHER-S" ~ html("<b>Other structural</b>\n<i>Other structural covariate not otherwise listed</i>"),
    "Overall" ~ html("<b>All covariates</b>"),
    .locations = cells_stub()
  ) |>
  cols_hide(c(Category, Summary)) |>
  fmt_percent(decimals = 0) |>
  sub_missing(missing_text = "-") |>
  data_color(
    columns = where(is.numeric),
    method = "numeric",
    palette = "viridis",
    alpha = 0.5
  ) |>
  tab_style(locations = cells_stub(rows = "Environmental"),
            style = cell_fill(color = "aquamarine4", alpha = 0.5)) |>
  tab_style(locations = cells_body(rows = "Environmental"),
            style = list(cell_fill(color = "aquamarine4", alpha = 0.5),
                         cell_text(weight = "bold", style = "italic",
                                   color = "black"))) |>
  tab_style(locations = cells_stub(rows = "Structural"),
            style = cell_fill(color = "plum4", alpha = 0.5)) |>
  tab_style(locations = cells_body(rows = "Structural"),
            style = list(cell_fill(color = "plum4", alpha = 0.5),
                         cell_text(weight = "bold", style = "italic",
                                   color = "black"))) |>
  tab_style(locations = cells_stub(rows = "Overall"),
            style = cell_fill(color = "gray60", alpha = 0.5)) |>
  tab_style(locations = cells_body(rows = "Overall"),
            style = list(cell_fill(color = "gray60", alpha = 0.5),
                         cell_text(weight = "bold",
                                   color = "black"))) |>
  tab_style(locations = cells_row_groups(),
            style = cell_text(color = "white")) |>
  as_raw_html()
```
:::

Covariate data for studies in our sample was either collected directly by researchers (17% of environmental covariate data), or derived from pre-existing remotely sensed datasets (83%); this of course varies depending on the category of covariate. Directly collected data can generally be expected to represent finer-scale factors like prey species occurrence or details of habitat structure, which can be difficult to measure remotely but can often be more proximal drivers of occupancy. These high quality covariates do come with trade-offs, as they can be expensive to collect and can often preclude projection to locations where data are unavailable. For projects interested in making these projections, remotely-sensed covariates are generally more feasible despite their generally more distal nature [@austin2002]. 42% of environmental factors and 87% of structural factors included in reviewed articles were dynamic covariates which varied through time — this again varied with the category of covariate in question, with terms relating to climate or weather most frequently dynamic and topographic covariates universally static.

In the standard DOM, covariates for each parameter are most commonly incorporated via a logistic regression (i.e., a linear regression through a logit link function). Statistical relationships between covariates and model parameters are represented as linear terms unless otherwise specified. Of course, many ecological relationships are non-linear and require more complex forms to be realistically represented in a model. @austin2007 discussed the importance of modelling ecologically-realistic responses to covariates, advocating for careful consideration of the most appropriate statistical form for hypothesised relationships. However, linear models are quite flexible, and non-linear responses can be easily accommodated using polynomial terms and interactions between covariates. Despite this, in our sample just 35% of articles considered using at least one non-linear responses to an environmental covariate, with the majority of studies representing all covariates as simple linear relationships. Interactions between covariates were similarly rare, with only 26% of studies considering at least one relationship between terms. The relatively low emphasis on more complex non-linear responses contrasts with other popular methods for modelling species occupancy. Many common approaches for SDMs, which include MAXENT and Boosted Regression Trees, permit considerable flexibility in the shape of their covariate response curves where supported by the data [@merow2013; @elith2008]. This emphasis on more complex responses in SDMs may be due to their typically larger range-wide scale which encompasses the full species niche, where environmental relations may be expected to be non-linear. However, as previously indicated DOMs have been frequently implemented at similarly large spatial scales where the same assumptions should exist and similar responses might be expected. Similar concerns exist for the relatively low level of interactions between covariates: while they should not necessarily be used liberally, where these exist their exclusion can influence model performance [@guisan2006].

In addition to the types of covariates considered for modelling we also measured the size of the candidate covariate pool in each reviewed study, tallying the number of environmental and structure covariates which were available for use on each parameter ( @fig-covariates). This is an area of considerable variation in modelling practices — the number of covariates considered for each parameter ranges from 0 (effectively modelling the parameter as a constant) to over 40 possible factors.

![The number of covariates considered for each parameter across all studies in our sample. 'Occupancy' given here represents an alternative parameterisation of the DOM which jointly estimates Occupancy for every season, Colonisation, and Detection, where Extinction is a derived parameter; this differs from the more popular Initial occupancy/Colonisation/Extinction/Detection parameterisation. Here, a 'covariate' is defined as each distinct covariate considered for inclusion. Linear and quadratic representations of the same covariate are counted as 1 covariate.](Figures/CovParamPlot.jpeg){#fig-covariates}

The median number of covariates varies strongly by parameter, with transition probabilities (colonisation and extinction) more likely to consider a broader range of environmental covariates relative to initial occupancy and detection. The lack of any covariates considered for initial occupancy in many studies (37% of articles) is particularly notable — unless a study is conducted at very small extents or study sites are truly uniform in their suitability, one would expect some amount of non-random variation in occupancy probability across any study system that will not be captured when representing initial occupancy as a constant. Omission of the factors which drive occupancy is a known source of bias in static SDMs [@barry2006], which the initial occupancy component of the DOM conceptually resembles. Furthermore, any bias in occupancy estimation in the first time-step will perpetuate into future seasons due to the DOM's Markovian nature with implications for the reliability of model outputs. Detection probability is also typically represented with low quantities of environmental covariates. Recall that detectability is dependent on not only observation factors, but also by drivers of abundance and species use; the low number of candidate covariates here relative to colonisation and extinction raises additional questions on whether this variation is always appropriately captured in models.

To this point in our review, we have discussed only the covariates which were *considered* for inclusion in DOMs without regard for which terms were actually *included* in the final models used by authors to make their inference. Identifying the 'best' model from a range of possible candidates can be a challenging process, especially for hierarchical models like DOMs [@doherty2012]. Consider that the quantity of candidate models involving up to *n* covariates on *p* parameters can be given by $(2^n)^p$; where a simple single-parameter may have up to 64 possible combinations of 6 covariates, a 4-parameter dynamic occupancy model would have 16 million combinations. This explosion of candidate models generally precludes exhaustive comparisons of possible models and requires a reduction of the models tested. Models in our sample include both Frequentist (n = 70) and Bayesian (n = 22), which differ considerably in their manner of implementation. A summary of modelling practices in DOMs is given in @tbl-modelling below.

```{r Modelling summary table}
#| echo: false
#| message: false
#| label: tbl-modelling
#| tbl-cap: "Modelling practices in dynamic occupancy models, subset by frequentist or bayesian implementations. The median covariate count presented here represents the median quantity of covariates considered for each model parameter across the studies in our review. The model selection methods represented in this table are non-exclusive and some articles employ multiple approaches."
 
modellingSummary <- read_csv("Figures/ModellingSummary.csv")

modellingSummary |>
  mutate(Variable = fct(Variable, 
                        levels = c("Number", "MedianCovs", 
                                   "Prop_AnySelect", "Prop_Candidate",
                                   "Prop_Sequential", "Prop_Simple",
                                   "Prop_ModAvg", "Prop_GOF", 
                                   "Prop_Eval"))) |>
  arrange(Variable) |>
  mutate(Variable = as.character(Variable)) |>
  gt(rowname_col = "Variable") |> 
  tab_row_group(
    label = "Covariate selection methods",
    rows = c("Prop_AnySelect", "Prop_Candidate",
             "Prop_Sequential", "Prop_Simple", "Prop_ModAvg"),
    id = "select"
  ) |>
  tab_row_group(
    label = "Model evaluation conducted",
    rows = c("Prop_GOF", "Prop_Eval"),
    id = "eval"
  ) |>
  row_group_order(groups = c(NA, "select", "eval")) |>
  text_case_match("Number" ~ "Number of studies",
                  "MedianCovs" ~ "Median covariates considered per parameter",
                  "Prop_ModAvg" ~ "Percentage using model-averaging",
                  "Prop_AnySelect" ~ "Percentage using any model selection approach",
                  "Prop_Sequential" ~ "Percentage using procedural model selection",
                  "Prop_Simple" ~ "Percentage selecting covariates with simpler models",
                  "Prop_Candidate" ~ "Percentage comparing models in a candidate set",
                  "Prop_GOF" ~ "Percentage calculating goodness-of-fit",
                  "Prop_Eval" ~ "Percentage assessing predictive performance",
                  .locations = cells_stub()) |>
  fmt_percent(rows = 3:9, decimals = 0) |>
  fmt_integer(rows = 1) |>
  tab_stub_indent(
    rows = 3:9,
    indent = 3
  ) |>
  tab_style(
    locations = cells_row_groups(),
    style = cell_text(style = "italic")
  ) |>
  tab_style(
    locations = cells_column_labels(),
    style = list(cell_fill(color = "aquamarine4"),
                 cell_text(color = "white"))
  ) |>
  tab_style(
    locations = cells_body(columns = "All models"),
    style = cell_text(style = "italic")
  ) |>
  as_raw_html()
```

The largest differences between the frequentist and Bayesian models in our sample lie in their approaches to model selection. Where 94% of frequentist models perform some manner of model selection to determine covariate inclusions for their models, only 36% of Bayesian models do so, with the majority instead fitting a single model defined *a priori*. Methods used for model selection vary considerably both within and between modelling frameworks. For frequentist models, the most popular and conventional approach to model selection as used in 43% of articles involves the creation of a fully pre-defined model set containing some number of hypothesis candidate models, where the best model is selected according to the lowest AIC score. Most frequentist studies which do not follow this protocol instead use procedural model selection methods (39% of articles), where the structure for each model parameter is fit one-by-one. For example, this protocol might first identify the best structure for detection probability before moving on to initial occupancy and so on. A smaller portion of frequentist studies (9%) use more unique approaches, fitting simpler models such as single season occupancy models for candidate covariates to identify the most informative terms to use in a DOM. Across all frequentist implementations, 71% of articles conduct multi-model inference and model-averaging using AIC weights [@burnham2004].

Those Bayesian models which *do* perform model selection tend to take distinctly different approaches, with largely idiosyncratic methods across these studies. While direct comparison of model fit is rare, it is feasible — @urban2023 identifies the best model from a Bayesian candidate set using the predictive performance on both in and out-of-sample validation data. Another approach used by @cook2022 fit a global model including all covariates before removing each covariate where the 95% credible interval of the posterior distribution overlapped zero and refitting the model. @ahumada2013 takes a hybrid approach, in which model selection is conducted by a procedural method in the frequentist framework before refitting the best structure in a Bayesian model.

Limited research has been conducted on advantages of different methods for covariate selection in DOMs, and there is surely no one-size-fit all approach which will be appropriate for all possible use-cases. However, it is important to consider the implications of the different model selection approaches in common usage, and research from the SDM literature highlights how covariate selection can influence our interpretation of model outputs [@brodie2020]. Within the occupancy modelling literature, @stewart2023's article on covariate selection in single-season occupancy model discusses important attributes of the information-criteria approaches widely used in frequentist models in our review, noting that these approaches can lead to inaccurate estimates and influence model inference. @morin2020's work raises different concerns on procedural model selection methods, demonstrating how the fine details of modelling protocols can determine whether the best-fitting possible model is identified and which covariates appear in final models. The literature on performance of Bayesian model selection methods is more sparse, although @hooten2015's guide to Bayesian model selection in ecology is a valuable resource for possible methods of fitting those models.

With few exceptions, most of the model selection methods identified in our review are designed only to identify the best model of those considered, and do not necessarily guarantee that selected models are well-fit to the data. Assessment of the performance of DOMs generally requires additional steps, and the best ways to achieve this are not necessarily clear. There is no broadly-accepted goodness-of-fit test for dynamic occupancy models, although @mackenzie2004 describes an approach for single-season occupancy models using a parametric bootstrap which can been extended to DOMs; this test is implemented in the *AICcModAvg* and *unmarked* R packages. @kéry2021 describe the test and present an alternative based on separately assessing fit to static and dynamic components of the model. In Bayesian implementations, posterior predictive checks offer means to assess model fit [@gelman2014]. @broms2016 discusses possibilities for model evaluation in the Bayesian context focusing on single-season multi-species occupancy models but extensions of their approach may also be applicable to the DOM. As in other hierarchical models, model evaluation for DOMs can in general can be difficult and somewhat uncertain compared to other model types, as the primary response variable of interest (species occupancy) is a latent variable where the true state is generally not known. Predictive performance evaluation is thus typically based on *observed* occupancy data, where a DOM is used to simulate detection histories to be compared with field survey results.

Perhaps as a result of this uncertainty, assessment of model fit and model performance was rare amongst the articles in our sample. Only 19% of studies tested for goodness-of-fit, and just 10% calculated predictive performance. These rates are considerably lower than for models like SDMs; for which @araújo2019's review of applications found closer to 50% articles testing both fit and performance.

# Modelling objectives

Studies in our sample were classified according to their objectives as stated by authors to explore the use-cases which DOMs have been applied for. These objective categories were non-exclusive, and many studies fell into multiple categories; the frequency at which studies pursued each of these objectives is shown in @fig-objectives A. Across our study period DOMs have been frequently employed to observe trends in species occupancy, to explore relationships between environmental factors and occupancy, and, increasingly often, to make predictions of occupancy spatially to unsurveyed locations or temporally to hypothetical future conditions. Within each of these broad categories lies even more variation in objectives, emphasising the DOM's flexibility as a tool for making ecological inference in diverse contexts.

Many articles in our sample used the DOM seeking to monitor trends in occupancy state through time. These studies include @ahumada2013's paper assessing populations trends of 13 forest mammals and @scott2015's assessment of the conservation status of the endangered flattened musk turtle. These studies offer valuable insights on the state of species across landscapes and through time, demonstrating DOMs' suitability for many monitoring oriented projects — including those where many species need to be assessed at once. Other articles were more focused on examining the factors which influence species occupancy, either testing a pre-specified hypothetical relationships or taking a broader tack to identify drivers of occupancy without preconception. The distinction between the two is important, as it guides which covariates may be considered and how model selection may be used to fit models. Many of these studies target core conservation priorities for their focal species, like @olson2005's early DOM assessing the influence of barred owls on threatened spotted owl. Explorations of these pivotal relationships are important for guiding management action, and may also be used to test the effectiveness of these actions as in @miller2023's study on American Kestrel nest boxes. In scenarios where less is known about species habitat preference, DOMs may be used to examine the influence of a wider variety of factors as illustrated in @huber2017's study testing the relative influence of dozens of habitat covariates on Wood warbler occupancy. In recent years, increasing numbers of articles have used to DOM to generate predictions of species occupancy. As examples, @mcgowan2020 provides projections for the threatened Black rail under multiple management scenarios, and @pollentier2021 generates maps of distributions resembling those made with SDMs, outputs which can immediately be used by managers to inform action.

![A) Shows the proportion of articles in each year-strata and across all years which match each of six non-exclusive objective categories. B) Shows the quantity of covariates considered per parameter for models which pursued each objectives. Studies focused on methods development typically considered the fewest covariates, where those attempting to identify the drivers of occupancy considered the most.](Figures/ObjectiveFigure.jpeg){#fig-objectives}

The objectives of studies fitting DOMs strongly inform approaches to the model building process, particularly with respect to covariate selection. @fig-objectives B shows the quantity of covariates considered for models applied to each of our objective categories, and the differences between objectives are apparent. Not unexpectedly, articles which focused on describing new methods for DOMs had fewer covariates than those studies focused on more applied objectives. However, differences persist between those articles observing trends, identifying trends in occupancy, testing relationships, and making predictions.

# Synthesis and key priorities

Approaches to building any type of model will necessarily depend on the possibilities of the data at hand and on the priorities of the model-builder. This precludes any prescription of the 'best' way to build a model, however, there are still important discussions to be had on decisions made in the modelling process. One aspect of fitting DOMs meriting broader discussion revolves around 'model complexity,' and how much must be incorporated into models to reliable model species occupancy under different contexts and use cases. Complexity is a broad term which encompasses many aspects of a model [@merow2014], and opinions on simplicity versus complexity in ecological models can be divisive. Where some advocate for the simplest possible models, arguing that they are most generaliseable; others insist that overly-simple models cannot adequately represent the most important drivers in a system [@evans2013; @lonergan2014]. By their nature DOMs are somewhat more complex than simpler models for studying occupancy thanks to their hierarchical structure, attributes which are necessary to control for detectability and to capture occupancy dynamics. Within this structure, however, further complexity is to some degree up to the modeller: one can choose how many covariates to consider for inclusion on the various parameters, and how to represent the nature of the relationship between those covariates and parameters. Research from SDMs indicates that allowing for more complex relationships can improve model performance in predicting occupancy [@valavi2023], an increasingly popular use-case for DOMs. Within the DOM framework, there are exciting developments on that front — @joseph2020 presents a novel neural-network occupancy model which allows for exponentially higher levels of complexity and may offer improved performance for prediction-oriented studies.

Generally speaking, covariate selection seems to be a particularly important area for further investigations into building DOMs. In our review, we see little consensus around which approaches are most applicable for any given use case, and existing work on covariate selection in DOMs raises concerns on whether common methods always produce the most suitable models. This is true for both frequentist and Bayesian implementations, and comparative research on covariate selection under both frameworks may help to inform model users on which method may be most appropriate for their use-cases. In a similar vein, the low number of articles in our review which conducted model evaluation or assessed model fit raises different questions. While the appropriate method of model evaluation may depend on data availability and research objectives, assessing models by some method is generally important to understand how reliable model outputs may be [@araújo2005; @guisan2005]. Existing uncertainties around whether current methods are suitable for the task surely discourage users from calculating these metrics, and further research is needed to establish trusted practices for assessing the quality of DOMs.

These priorities are particularly important given the frequent applied objectives of DOM users, tackling challenges which include assessing critically endangered species [@carvalho2023], guiding public health management of disease vectors [@moreira2016], and tracking rapidly developing biological invasions [@wood2020]. DOMs are well suited to these situations, and it is to be expected that as these types of applications are more commonly attempted understanding the sensitivity of model outputs to decisions made in the model fitting process becomes increasingly important. In the two decades since the publication of @mackenzie2003 the dynamic occupancy model has become a widely used tool for ecological inference, with numerous extensions to the modelling framework further broadening the scope of questions and use-cases for which it may be applied. Given their increasing popularity, further research and guidelines around issues of model building may help to make the DOM format more accessible to newcomers and support confidence in interpretation of models. Parallels to existing work in the SDM literature on guidelines for reporting and modelling standards could be valuable contributions in achieving these aims [@zurell2020; @araújo2019] while specifically addressing model attributes unique to DOMs.
