---
title: "Twenty years of dynamic occupancy models: a review of applications and look towards the future"
date: today

authors:
  - name: Saoirse Kelleher
    affiliation: University of Melbourne
    email: saoirse.kelleher@student.unimelb.edu.au
    orcid: 0000-0002-4614-5753
    corresponding: true
  - name: Natalie Briscoe
    affiliation: University of Melbourne
  - name: Gurutzeta Guillera-Arroita
    affiliation: Pyrenean Institute of Ecology, Spanish National Research Council
  - name: Jane Elith
    affiliation: University of Melbourne
    
abstract: | 
 Understanding the patterns by which species occur across landscapes and throughout time is a long-standing objective of ecological research which has inspired the development of numerous quantitative modelling approaches for the task. However, estimating occupancy can be a challenge, particularly where issues like imperfect detection and shifting distributions exist. Dynamic occupancy models (DOMs) offer a framework for occupancy estimation which explicitly accounts for observation error while incorporating additional mechanistic process by estimating colonisation and local extinction. In light of increasing interest in more process-explicit models for understanding species occurrence, here we examine how DOMs have been applied to field ecological data in the two decades since their introduction. Following a general introduction to the model, we present the results of a systematic review exploring the research contexts where DOMs have been applied and interrogating how authors have built their models, with particular emphasis on how covariates are incorporated to describe variation in occupancy dynamics. Our findings indicate that DOMs are a flexible tool readily applied to diverse study systems and data types, with their usage expanding in recent years as more studies apply them to make spatial and temporal prediction of species occupancy. DOMs are also amenable to extension, further broadening their utility. Despite their flexibility, model complexity in DOMs tends to be low; most studies consider relatively few covariates, most of which are represented as simple linear relationships. Approaches to covariate selection also vary considerably, and there remains little research on how these choices may influence model performance. Furthermore, only a fraction of articles report evaluating models and little guidance exists on how to approach this task in DOMs. These uncertainties in the modelling process should be key priorities for future research on DOMs given their increasing use in applied ecological research.

format:
  html:
    theme: simplex

embed-resources: true
title-block-banner: true
---

# Introduction

The description of patterns of species occupancy across landscapes has been a long-standing subject of ecological research [@humboldt1849]. Estimates of how widespread a species is and where it occurs are the foundation of monitoring programs and important for assessing conservation status, and identifying potential drivers of occurrence can help inform potential management actions [@mackenzie2013]. Robust knowledge of the occupancy patterns of a species can also help us to predict where a species is most likely to occur, both under present conditions and in hypothetical future scenarios [@kéry2013].

While occupancy is a useful concept, it is also a challenging quantity to describe, measure, and estimate. The need to understand and quantitatively describe species occupancy has led to the development of several popular modelling approaches, including stochastic patch occupancy models [@gutiérrez-arellano2024] commonly applied to study meta-population dynamics, and species distribution models [SDMs, @franklin2010] widely used to explore species occurrence at larger scales. However, several factors can make occupancy difficult to estimate. For instance, simple presence/absence data of species observations can be biased when species are detected imperfectly, as is the case with much wildlife field data — generally speaking, it is impossible to determine whether a location is truly unoccupied or whether the species occurs but was not detected by the observer [@lahoz-monfort2014; @gu2004]. Despite the ubiquity of imperfect detection in data collection, many models fit to presence/absence data make no adjustment for this source of bias [@kellner2014]. Another challenge for modelling occupancy is the difficulty in describing populations under non-equilibrium conditions, where a species' occurrence pattern and relationship to its environment is in flux [@dormann2007; @elith2010]. These conditions often occur during biological invasions and climate change driven range shifts, both conservation priorities and increasingly common scenarios in the Anthropocene [@bertelsmeier2013; @lenoir2015].

The site occupancy models first introduced by @mackenzie2002 set the foundation for a powerful framework for modelling presence/absence data while accounting for each of these challenges [@guillera-arroita2017a] . Drawing on principles from the mark-recapture literature, occupancy models use multiple resurveys of sites to estimate detection probabilities and correct for bias in estimates of site occupancy. Originally a static model, @mackenzie2003 extended this model for use in multiple time-steps by explicitly describing the process of changing occupancy via colonisation and extinction, relaxing assumptions of equilibrium and allowing description of patterns of site occupancy through time. This dynamic occupancy model (DOM) balances complexity and feasibility, explicitly describing the key processes which drive occupancy dynamics while requiring reasonably simple-to-collect presence absence/data instead of the detailed demographic or abundance data required by more process-explicit models [@briscoe2019]. These features make the DOM an important tool, with uses including hypothesis testing of relationships between occupancy and the environment, explorations of the key drivers of occupancy, and even prediction of occupancy under future conditions [@kéry2013; @briscoe2021].

In this review we examine how dynamic occupancy models have been used by ecologists in the two decades since their inception. Following an introduction to the model's form and assumptions, we present the results of a systematic review exploring how researchers have applied DOMs to ecological data, with emphasis on how they collected their data, selected covariates, and evaluated their models. Based on these results we highlight the DOM's flexibility as a tool for understanding species occurrence, examine approaches to the model building process, and outline key priorities for future research involving this model class.

### Dynamic occupancy model form and assumptions

The DOM structure encompasses two processes: the ecological process of site occupancy dynamics describing the presence or absence of a species at a site at any point in time, and the observational process of detection describing whether a species is observed at a site where it is present (@fig-modelform). Sites can exist in either an occupied (z = 1) or unoccupied state (z = 0). In the first time step, occupancy state at each site is determined by the probability of initial occupancy ψ~1~, i.e., $z_1 \sim Bernouilli(\psi_1)$. In following time steps, occupancy state can change according to a Markovian process where occupancy is predicated on the site's state in the prior time-step and the probabilities of colonisation γ and local extinction ε, such that $z_t \sim Bernoulli(\psi)$ and $\psi = z_{t-1}(1-\epsilon)+(1-z_{t-1})\gamma$. The observation component of the DOM explicitly accounts for imperfect detection. At occupied sites, the detection probability ρ describes whether the species is observed during a survey (y = 1) or not (y = 0), according to the formula $y_{t,j} \sim Bernouilli(z_t\rho)$. Under the DOM's original parameterisation, it is assumed that false-positive detections at unoccupied sites never occur. In this review we use the term "parameter" to refer to the quantities being estimate: in most cases, these are initial occupancy ψ~1~, colonisation γ, extinction ε, and detection ρ (see @fig-modelform). However, some alternative model forms may directly estimate occupancy ψ as a parameter.

![The form of the dynamic occupancy model as described by @mackenzie2003. The ecological process sub-model describes changes in occupancy over time, while the observational process sub-model describes detectability.](Figures/ModelForm.png){#fig-modelform}

To disentangle the ecological and observational processes the DOM requires a hierarchical sampling design as depicted in @fig-surveys. Under this design, observations at a site occur during distinct, time-bound seasons within which it is assumed site occupancy does not change (that is, sites are closed to changes in occupancy). In each season multiple observations are conducted, permitting estimation of the probability of detection conditional on occupancy. Most frequently these repeat observations are collected by revisiting the site on separate occasions, although they can also be attained by alternative means: examples include conducting surveys at multiple locations within a site, using multiple observers during a survey, or recording the time elapsed until a detection is recorded [@guillera-arroita2017a; @guillera-arroita2017b]. It is important to note that it is not necessary for the same number of observations to occur in each year or for each site, and that the DOM accommodates for missing data; this enables flexibility in data inputs.

![The sampling design of the standard dynamic occupancy model. During seasons (also called primary occasions) sites are considered closed to changes in true occupancy state; occupancy state may only change between seasons. Within each season, multiple observations (also called surveys or secondary occasions) are conducted to record the observed presence or absence of the species at each site. These multiple observations may be recorded in many ways: sites can be revisited multiple times within a season, surveys can be conducted at multiple points within a larger site, multiple observers can conduct surveys contemporaneously, or the time elapsed prior to a detection occurring can be recorded. Note that it is not necessary for each site or season to have the same number of observations, and that missing data can be accommodated.](Figures/SurveyDesign.png){#fig-surveys fig-align="center"}

DOMs make several key assumptions requiring careful consideration by model users, which we outline here as our review interrogates related aspects of model building.

I.  **False positive detections do not occur**. While this assumption can be safely met in many studies, it is not necessarily guaranteed when working with more cryptic species or less reliable survey methods. @mcclintock2010 and @miller2015 comment on the bias induced when false positives occur and are not accounted for, highlighting the need to consider how certain detections truly are for any given study system. Significantly, even genuine detections of a species can be considered 'false positives' when they do not represent the intended definition of occupancy, such as detections of transient individuals when the intent is to estimate breeding occupancy [@berigan2019]. Where this assumption can not reasonably be met, model extensions designed to account for false positive error should be considered [@royle2006; @miller2011; @miller2015].

II. **Sites are closed to occupancy between seasons.** This requirement, best known as the 'closure assumption,' has also been subject to considerable discussion in terms of the bias introduced when it is violated [@rota2009; @otto2013]. Closure is dependent not only on the life history of the species, but also on the definition of occupancy used by researchers — short seasons may represent dynamics more representative of species 'use,' and it can be difficult to distinguish local extinction from temporary emigration [@valente2017]. Model extensions to relax the closure assumption have been developed, including approaches using staggered arrival and departure periods between sites [@kendall2013]. A more pertinent approach for most studies, however, is careful consideration of the appropriate definition of occupancy under the survey design used [@steenweg2018].

III. **Heterogeneity in occupancy and detection is accounted for.** As with any approach for modelling species occurrence, it is assumed that DOMs appropriately capture variation in occupancy patterns and species detectability across the study system. Generally, this is achieved by allowing model parameters (ψ~1~, γ, ε, and ρ) to vary with respect to covariates representing the environmental factors which may be expected to influence these parameters. An important element of this assumption is that the likelihood of detection of a species can depend not only on the observability of the species, but also on factors like habitat suitability which influence species abundance and activity [@guillera-arroita2017a]. While no model will fully account for the complexity inherent in patterns of species occupancy and detection, failure to capture key drivers is likely to introduce bias and confound inference made from model estimates [@barry2006]. Compared to the first two assumptions mentioned, this aspect of DOMs has been less thoroughly discussed and comparatively little is known about how this latent heterogeneity can influence model performance.

Since its original description in @mackenzie2003, the DOM has been further developed with numerous model extensions and alternative formulations including aforementioned implementations accounting for false positives [@royle2006; @miller2011; @miller2015], multiple states beyond occupied and unoccupied [@nichols2007], and jointly estimated multi-species models [@dorazio2010]. For a comprehensive discussion of common extensions and their applications see @bailey2014 and @guillera-arroita2017a, as well as @devarajan2020 for a more detailed review of multi-species occupancy models.

# Systematic review methods

To assess how DOMs have been applied in the years since their introduction we gathered a representative sample of articles fitting them to field ecological data. A pool of candidate articles was generated using two queries on Web of Science. The first of these included all articles from 2004-2023 which cite @mackenzie2003. To capture any additional relevant articles that did not directly cite @mackenzie2003, a second query was generated searching articles in the same time-span matching the terms "*dynamic occupancy model\**", "*multi-season occupancy model\**", or "*occupancy dynamic\**"; articles including each of "*occupancy*", "*colonization*", "*extinction/persistence*", and "*detection*"; and articles with the term "*occupancy*" located near "*dynamic*" in the title, key terms, or abstract. These queries resulted in 1469 articles: 897 were retrieved only from the MacKenzie citations, 274 only from the keywords search, and 298 which appeared in both queries. As we were interested in how DOMs use has changed through time, we divided all articles across four-year-long strata spanning 2004-2007, 2008-2011, 2012-2015, 2016-2019, and 2020-2024. From each of these strata we randomly selected 20 articles for inclusion in the review. Articles that did not meet inclusion criteria were replaced from within their own strata.

As our review focuses only on applications of the dynamic multi-season occupancy model of @mackenzie2003 and its extensions, we included articles that fit a model meeting the following criteria: i) used non-simulated, field-collected, presence-absence data; ii) relied on data from multiple sites which could exist in at least two states, including an occupied and unoccupied state; iii) had multiple seasons, between which sites could change states conditional on the prior season's occupancy state and transition probabilities such as colonisation and extinction; and iv) contained at least one parameter describing the detection process.

For each article we recorded key details on authorship, research objectives, study taxa and system, survey methods, and modelling approach. To examine the reasons why authors used DOMs, we allocated each article to one or more category of objective based on the study's stated aims. The possible categories were *Estimating trends*, where authors express interest in estimates of site occupancy, colonisation, extinction, or detection probabilities; *Testing relationships*, where authors explore specific predefined hypotheses of relationships between covariates and model parameters; *Identifying drivers*, where authors attempt to find which covariates influence model parameters; *Predicting temporally*, where authors predict site occupancy under future conditions, *Predicting spatially*, where authors predict site occupancy to unsurveyed locations, and *Developing methods*, where authors introduce, test, or demonstrate aspects of dynamic occupancy models.

We recorded details on the type of organisms (bird, mammal, etc.) modelled in each article, and the means by which multiple species were modelled where applicable. Taxa were denoted as threatened either when they are listed on the IUCN Red List of Species or when authors indicate that they are threatened. This deference to authors' representation of conservation status was made to account for sub-species which lack listings or species which are of more local concern. Study locality and size was documented; the size of the study area being defined as the intended area of inference which contained all sites — this was measured to the order of magnitude to account for uncertainty in reporting.

We were particularly interested in how authors navigated the modelling process, from covariate selection through model evaluation. To this end, we recorded all covariates considered in each study regardless of whether they were or were not included in final models. Key traits of each covariate were recorded including their general category, whether they were directly observed or remotely sensed, whether they were static or varied between seasons, and how they were presented in the model (as a linear term, a polynomial term, or as part of an interaction with another covariate [@james2021]). Model selection procedures were also sorted into non-exclusive categories including *A priori*, where only one model was considered; *candidate suite*, where a predefined set of models was considered; *sequential,* where covariates were selected parameter-by-parameter (e.g., fitting detection first, followed by initial occupancy and so on); and *simple precursors*, where selection was preceded by another simpler model implementation. Finally, for each model we documented whether goodness-of-fit was tested and reported, and whether model performance was assessed by validation with either in or out-of-sample data. For the full spreadsheet of data collected and further details on categorisation, see supplementary material.

# Applications of dynamic occupancy models

A total of 92 articles were included for this review. Based on the acceptance rates within each stratum and quantity of unprocessed articles, an estimated 496 of the 1152 unreviewed articles in our sample would have met inclusion criteria, with an apparent increase over time in the number of articles fitting DOMs (@fig-coverage).

![Bars indicate the 92 articles included in our review as a proportion of the estimated number of published articles fitting DOMs, based on the qualification rate for articles in each strata. The proportion of articles included from each strata were as follows: 12% from 2005-2008; 24% from 2008-2011; 42% from 2012-2015; 35% from 2016-2019; and 57% from 2020-2023.](Figures/CoveragePlot.jpeg){#fig-coverage}

The articles included in our review demonstrate considerable diversity in scope, scale, and objectives. A selection of attributes of these studies is presented in @fig-StudyDetails, and throughout this section we provide notable examples of DOMs to highlight how the noted variation appears in practice. Study systems included in our sample are globally distributed: while a majority of articles use data collected in the United States of America, representatives are included from all geographic realms and a broad diversity of ecosystems (@fig-StudyDetails A). A particularly notable aspect of these study areas is their variation in size, which ranges from the hyper-local to the continental scale (@fig-StudyDetails B) . The smallest study locality included in our sample studied insect occurrence in a rainforest plot less than one square kilometre, while the largest analysis modelled avian range shifts across the entire eastern half of the United States [@basset2023; @clement2019].

The temporal scale of studies shows similar variability. The time elapsed between the first and last survey ranged from under one month to over forty years, with a median duration of 8 years (@fig-StudyDetails F). More meaningful, however, is the period of the primary occasion, as this represents the temporal scale at which changes in occupancy are assumed to occur. Most applications describe primary occasions as occurring annually, although some studies divide years into multiple primary occasions to describe seasonal variation in occupancy. In the most extreme cases the primary occasion may be as brief as a week and capture much finer scale changes in occupancy. These shortened-season occupancy models are most common with camera trapping or acoustic monitoring data, which can be arbitrarily divided into primary and secondary sampling occasions. One example of this is @kleiven2020's study of rodent and mustelid interactions using camera trap data, which used primary occasions less than one week in length. On the other end of the spectrum, some studies modelled primary occasions which were decades apart and represented generational changes in occupancy. This is illustrated in @couturier2023's study on long-term otter recovery in France which used data from two primary occasions: one in 2003 and one in 2012.

DOMs have been used to study a variety of species, though the majority of studies have focused on vertebrate taxa (@fig-StudyDetails C). The DOM has been less frequently applied to non-animal organisms, perhaps due to a reduced emphasis on imperfect detection outside of the wildlife modelling community. However, there are exceptions, including DOMs used to model decadel changes in lichen occupancy and the spread of chronic wasting disease [@belinchón2017; @cook2022]. The latter's application to disease dynamics is not unique, and the DOM has been touted as a valuable tool for such applications [@bailey2014]. Multiple authors have also used DOMs to model mosquito dynamics, a strongly applied use-case with important human health implications [@mores2020; @padilla-torres2013]. The vast majority of studies model terrestrial species, though there have been a limited number of studies on aquatic systems, including invasive salmon, Great Plains stream fishes, and whales [@fisher2014; @falke2012; @pendleton2022].

While most studies in our sample fit a model to a single species, 44% fit models to multiple species either as independent models (34%) or explicitly multi-species implementations (12% — some articles attempted multiple approaches; @fig-StudyDetails D). The multi-species models use various extensions of the conventional DOM, including hierarchical models which fit hundreds of species in a single implementation with species-level effects [@dorazio2010; @hendershot2020], as well as explicit interaction models which estimate conditional occupancy, colonisation, extinction, and detection probabilities [@lesmeister2015; @fidino2019]. Rather than using multi-species models, several other authors fit large numbers of independent models to different species [@peach2019; @otto2012]. Working with large numbers of taxa does raise additional challenges, as the degree to which models are tailored to the taxa is likely to be limited for the sake of practicality.

![A) Locations of study areas where data was collected for reviewed DOMs. B) Spatial extent of study areas, defined as the area of inference, within which all surveyed points were contained. C) Number of articles which fit models to each category of taxa. Taxa were considered 'threatened' if they are listed on the IUCN Red List, or if authors indicate that they are otherwise threatened. D) Explicitly multi-species models include both hierarchical, jointly estimated models as well as more interactive models. Some studies fit both independent and multi-species models, such that these values do not sum to our sample size. E) Survey methods used to collected presence/absence data. Note that some articles employed multiple detection methods, and that some methods (e.g., citizen bird counts) may fall into multiple categories. F) Quantity of sites where surveys were conducted and duration of studies. Yellow bars indicate median values for site quantity (100) and study duration (8.2 years). Study duration is defined as the time elapsed between the first and last survey.](Figures/ReviewBox.png){#fig-StudyDetails}

Studies collected the presence/absence data required for DOMs from a breadth of different sources and detection methods (@fig-StudyDetails E). In our sample, 79% of studies used human observational data, 11% used live-trapping methods, and 14% used detections from camera traps. 10% of articles also use citizen-science data to build detection histories, including @zuckerberg2011's model using bird-feeder data and @warrier2020's using citizen reports of tiger signs. Using citizen-science data may require additional consideration of assumptions (particularly false-positives), as discussed in greater detail by @cruickshank2019. Within these broad categories of detection method there is additional diversity, with several studies using unique survey methods to determine the presence of a species at a location. For example, in the only application of a DOM for a marine species in our sample, @pendleton2022 used aerial transects broken up into grid cells to observe whale occupancy; in another unique implementation, @marescot2020 fit a unique 'multi-species' model treating poachers as a taxon and using ranger reports to create detection histories.

Notably, many of these studies use data which were not originally collected in a robust design framework for occupancy modelling. In these articles, authors formatted their data into a hierarchical format post-hoc using a variety of methods. Some defined primary seasons as a discrete time interval, treating all surveys occurring within the season as secondary occasions; others defined sites as larger grid cells, treating any survey falling within the grid as a spatial replicate. These manipulations permit authors to use data which predate the DOM, as in a study using surveys conducted by Joseph Grinnell in 1908 to model century-long changes in occupancy [@riddell2021].

Additionally, not all articles rely on a single source of detection data; some integrate multiple sources of data to maximise sample size. In one example, @warrier2020 modelled tiger occupancy in India using three sources of detections, including camera traps, sign surveys, and citizen science reports. These integrated detection method models do require additional care and consideration; users must ensure that different detection methods represent comparable spatial and temporal scales, and that any variation in perceptibility between detection methods is accounted for [@pitman2017]. A special case exists when different detection methods are used where one has the potential for false positive detections; e.g., where less-certain citizen science detections are combined with certain detections from field surveys. In this context, the "certain" detections are used to help account for false-positive detection probability, as in @miller2011's study integrating GPS collars and hunter reports to estimate wolf occupancy in Montana.

The flexibility in the data used for DOMs, including the model structure and the scale of observations, is not amenable to a one-size-fits-all definition of occupancy. Users of DOMs must carefully consider precisely what they are modelling and address questions on the scale represented by their model [@chave2013]. The interpretation of what 'occupancy' means and the factors which drive it may differ depending on the scale of what is considered a site, and how that relates to the ecology of a species. This is also true for the temporal scale of occupancy: whether a site is occupied within a week or within a year leads to vastly different conceptions of occupancy. This idea is particularly relevant in cases where the selection of season length *is* to some extent arbitrary, as with camera-trap or bioacoustic data where continuous recordings can be broken down into distinct 'seasons' of any length. The DOM may be readily applied to these data types, and the proliferation of autonomous survey techniques provides novel opportunities for analysis that is simply not possible with human-collected data [@balantic2019]. This is already apparent in recent camera trap studies which collapsed their detections into seasons of just a few days, far shorter than is realistic with conventional survey methods [@kleiven2020; @mölle2022]. While these studies provide interesting insights of occupancy at extremely fine temporal scale, further research could help provide general guidance on determining appropriate season and survey durations with respect to research questions and the closure assumption.

# Practices in implementation and model building

Building dynamic occupancy models can be a challenging process requiring careful consideration of which environmental factors to incorporate to adequately represent occupancy and detection in complex natural systems. In this review, we recorded all covariates considered for each model in our sample, including those not used in final models. These are summarised in a taxonomy presented in @tbl-covariates, which states the proportion of studies considering each type of covariate in their models, the means by which covariate data are collected, and how covariates responses are represented in DOMs. We further delineate their use in the model by classifying covariates into two groups: environmental covariates, representing plausible ecological correlates of parameters; and structural covariates, representing aspects of model form and observation functionally distinct from the environment. Our findings indicate that DOM users have incorporated a wide diversity of covariates in their models — while the most common varieties of covariates include aspects of habitat and land cover, a range of other unique factors were considered by authors in our sample. Many models incorporate covariates representing aspects of site geometry and connectivity (35% of studies). Often these are included as simple covariates, as in @duggan2011's models using landcsape connectivety metrics as covariates on colonisation and extinction. Alternatively, more complex parameterisations explicitly model colonisation or extinction as a spatial process, blending attributes of DOMs and stochastic patch occupancy models [@broms2016; @risk2011]. Several studies also include biotic interactions with other species as covariates, particularly those focused on taxa threatened by invasive species. This is observed frequently in the Spotted owl literature, where Barred Owl presence is often considered as a covariate driving Spotted owl occupancy dynamics [@olson2005; ; @sovern2014; @dugger2016]. The use of these types of covariates effectively incorporate species interactions in DOMs without requiring the use of more complex explicitly multi-species models.

::: column-page-inset
```{r covariate table}
#| echo: false
#| message: false
#| label: tbl-covariates
#| tbl-cap: "All covariates considered for inclusion in a study were classified into mutually exclusive categories. We calculate the percentage of studies which include at least one covariate of a given category on any parameter, Initial Occupancy (&psi;1), Occupancy (&psi;), Colonisation (&gamma;), Extinction(&epsilon;), and Detection (&rho;). We also present the average percentage of covariates in a category which are dynamic (varying through seasons) and directly observed, as well as the percentage of articles which model each category of covariate with a non-linear relationship or as part of an interaction with another covariate."

library(tidyverse)
library(gt)

covTable <- read_csv("Figures/CovariateTable.csv")

covTable |>
  mutate(Summary = case_when(Covariate %in% c("Environmental", "Structural", "Overall") ~ TRUE,
                             .default = FALSE)) |>
  arrange(Category, Summary, -Prop_Any) |>
  gt(rowname_col = "Covariate", groupname_col = "Category") |>
  tab_options(
    row_group.as_column = TRUE
  ) |>
  tab_row_group(
    label = md("Environmental covariates"),
    rows = Category == "E",
    id = "Env"
  ) |>
  tab_row_group(
    label = md("Structural covariates"),
    rows = Category == "S",
    id = "Struct"
  ) |>
  tab_row_group(
    label = md("All covariates"),
    rows = Category == "O",
    id = "All"
  ) |>
  tab_style(
    style = cell_fill(color = "aquamarine4"),
    locations = cells_row_groups(groups = "Env")
  ) |>
  tab_style(
    style = list(
      cell_fill(color = "plum4")
    ),
    locations = cells_row_groups(groups = "Struct")
  ) |>
  tab_style(
    style = list(
      cell_fill(color = "gray60")
    ),
    locations = cells_row_groups(groups = "All")
  ) |>
  row_group_order(groups = c("Env", "Struct", "All")) |>
  tab_spanner(label = "Percentage of articles with covariate on parameters:",
              columns = c("Prop_Any", "Initial occupancy", "Occupancy",
                          "Colonisation", "Extinction_Persistence",
                          "Detection"),
              id = "inclusions") |>
  tab_spanner(label = "Percentage which are:",
              columns = c(Prop_Dynamic, Prop_Direct),
              id = "covariates") |>
  tab_spanner(label = "Articles representing this covariate with:",
              columns = c(Prop_Nonlinear, Prop_Interact),
              id = "representations") |>
   cols_label(
    Prop_Any = "Any",
    `Initial occupancy` = html("&psi;1"),
    Occupancy = html("&psi;"),
    Colonisation = html("&gamma;"),
    Extinction_Persistence = html("&epsilon;"),
    Detection = html("&rho;"),
    Prop_Dynamic = "Dynamic",
    Prop_Direct = "Directly observed",
    Prop_Nonlinear = "Non-linear relationships",
    Prop_Interact = "Interactions between covariates"
  ) |>
  text_case_match(
    "Environmental" ~ html("<b>Any Environmental</b>"),
    "HABT" ~ html("<b>Habitat </b>\n<i>Aspects of habitat and land cover</i>"),
    "PHEN" ~ html("<b>Phenology</b>\n<i>Time-varying elements distinct from sampling occasions</i>"),
    "SPAT" ~ html("<b>Spatial</b>\n<i>Site geometry, connectivity, or other spatial elements</i>"),
    "OTHER-E" ~ html("<b>Other environmental</b>\n<i>Other environmental covariate not otherwise listed</i>"),
    "TOPO" ~ html("<b>Topography</b>\n<i>Elements of landscape topography</i>"),
    "HYDR" ~ html("<b>Hydrology</b>\n<i>Aspects of hydrology, such as distance to water</i>"),
    "CLWE" ~ html("<b>Climate/Weather</b>\n<i>Climate, weather, and natural disasters</i>"),
    "ANTH" ~ html("<b>Anthropogenic</b>\n<i>Relations to human activity</i>"),
    "BIOT" ~ html("<b>Biotic interaction</b>\n<i>Interactions with other (non-plant) species</i>"),
    "Structural" ~ html("<b>Any Structural</b>"),
    "SEAS" ~ html("<b>Primary occasion</b>\n<i>Effect of the primary occasion</i>"),
    "OBSE" ~ html("<b>Observation</b>\n<i>Details on the observation process</i>"),
    "SURV" ~ html("<b>Secondary occasion</b>\n<i>Effect of the secondary occasion</i>"),
    "SPEC" ~ html("<b>Species effect</b>\n<i>Species-level effects</i>"),
    "SITE" ~ html("<b>Site effect</b>\n<i>Site-level effects</i>"),
    "OTHER-S" ~ html("<b>Other structural</b>\n<i>Other structural covariate not otherwise listed</i>"),
    "Overall" ~ html("<b>All covariates</b>"),
    .locations = cells_stub()
  ) |>
  cols_hide(c(Category, Summary)) |>
  fmt_percent(decimals = 0) |>
  sub_missing(missing_text = "-") |>
  data_color(
    columns = where(is.numeric),
    method = "numeric",
    palette = "viridis",
    alpha = 0.5
  ) |>
  tab_style(locations = cells_stub(rows = "Environmental"),
            style = cell_fill(color = "aquamarine4", alpha = 0.5)) |>
  tab_style(locations = cells_body(rows = "Environmental"),
            style = list(cell_fill(color = "aquamarine4", alpha = 0.5),
                         cell_text(weight = "bold", style = "italic",
                                   color = "black"))) |>
  tab_style(locations = cells_stub(rows = "Structural"),
            style = cell_fill(color = "plum4", alpha = 0.5)) |>
  tab_style(locations = cells_body(rows = "Structural"),
            style = list(cell_fill(color = "plum4", alpha = 0.5),
                         cell_text(weight = "bold", style = "italic",
                                   color = "black"))) |>
  tab_style(locations = cells_stub(rows = "Overall"),
            style = cell_fill(color = "gray60", alpha = 0.5)) |>
  tab_style(locations = cells_body(rows = "Overall"),
            style = list(cell_fill(color = "gray60", alpha = 0.5),
                         cell_text(weight = "bold",
                                   color = "black"))) |>
  tab_style(locations = cells_row_groups(),
            style = cell_text(color = "white")) |>
  as_raw_html()
```
:::

Covariate data for studies in our sample was either collected directly by researchers (an average of 30% of environmental covariates per study), or derived from pre-existing remotely sensed datasets (70% of environmental covariates); this of course varies depending on the category of covariate (@tbl-covariates). Directly collected data can often represent finer-scale factors like prey species occurrence or details of habitat structure, which can be difficult to measure remotely but can often be more proximal drivers of occupancy. These species-specific covariates do come with trade-offs, as they can be expensive to collect and often preclude projection to locations where these data are unavailable. For studies interested in making such projections, remotely-sensed covariates are generally more feasible despite their generally more distal nature [@austin2002]. An average of 43% percent of environmental factors and 94% of structural factors included in reviewed studies were dynamic covariates which varied through time — this again varied with the category of covariate in question, with terms relating to climate or weather most frequently dynamic and topographic covariates universally static (@tbl-covariates).

In the standard DOM, covariates for each parameter are most commonly incorporated via a logistic regression (i.e., a linear regression through a logit link function) [@mackenzie2017]. Statistical relationships between model parameters and covariates (e.g., between initial occupancy and its environmental covariates) are represented as linear terms unless more complexity is specified. Of course, many ecological relationships are non-linear and require more complex forms to be realistically represented in a model. @austin2007 discusses the importance of modelling ecologically realistic responses to covariates, advocating for careful consideration of the most appropriate statistical form for hypothesised relationships. Non-linear responses can be easily accommodated in DOMs by using polynomial transformations and interactions between covariates. Despite this, in our sample only 35% of articles tested one or more non-linear responses to an environmental covariate, with the majority of studies representing all covariates as simple linear terms (@tbl-covariates). Interactions between covariates were similarly rare, with only 24% of studies considering at least one interaction between terms (@tbl-covariates). The relatively low emphasis on more complex non-linear responses contrasts with other popular methods for modelling species occupancy. Many common approaches for SDMs, such as MAXENT and Boosted Regression Trees, permit considerable flexibility in the shape of their covariate response curves and use of interactions where supported by the data [@merow2013; @elith2008]. This emphasis on more complex responses in SDMs may be due to their frequent application across relatively large geographic extents which might encompass the full species niche, where environmental relationships may be expected to be non-linear. However, as previously indicated DOMs have also been implemented across large spatial extents where the same assumptions should exist and similar responses might be expected. Similar concerns exist for the relatively low level of covariate interactions, given that these relationships are commonly expected based on ecological theory and that their exclusion can negatively impact model performance [@guisan2006].

In addition to the types of covariates considered for modelling we also recorded the size of the candidate covariate pool in each reviewed study, tallying the number of environmental and structural covariates which were available for use on each parameter ( @fig-covariates). This is an area of considerable variation in modelling practices — the number of covariates considered for each parameter ranges from 0 (effectively modelling the parameter as a constant) to over 40 candidates on a single parameter.

![The number of covariates considered for each parameter across all studies in our sample. 'Occupancy' given here represents the alternative parameterisation of the DOM which jointly estimates Occupancy for every season, Colonisation, and Detection, where Extinction is a derived parameter; this differs from the more popular Initial occupancy/Colonisation/Extinction/Detection parameterisation. Here, a 'covariate' is defined as each distinct covariate considered for inclusion. Linear and quadratic representations of the same covariate are counted as one covariate.](Figures/CovParamPlot.jpeg){#fig-covariates}

The median number of covariates varies strongly by parameter, with transition probabilities (colonisation and extinction) more likely to consider a broader range of environmental covariates compared to initial occupancy and detection. The lack of any covariates considered for initial occupancy in many studies (37% of studies) is particularly notable — unless a study is conducted at very small extents or study sites are truly uniform in their suitability, one would expect some amount of non-random variation in occupancy probability across any study system that will not be captured when representing initial occupancy as a constant. Omission of the factors that drive occupancy is a known source of bias in static SDMs [@barry2006], which the initial occupancy component of the DOM conceptually resembles. Furthermore, any bias in occupancy estimation in the first time-step will perpetuate into future seasons due to the DOM's Markovian nature with implications for the reliability of model outputs. Detection probability is also typically represented with low numbers of environmental covariates (@tbl-covariates). Recall that detectability is dependent on not only observation factors, but also by drivers of abundance and species use; the low number of candidate covariates here relative to colonisation and extinction raises additional questions on whether this variation is always appropriately captured in models.

To this point in our review, we have discussed only the covariates which were *considered* for inclusion in DOMs without regard for which terms were actually *included* in the final models used by authors to make their inference. Identifying the 'best' model from a range of possible candidates can be a challenging process, especially for hierarchical models like DOMs [@doherty2012]. Consider that the quantity of candidate models involving up to *n* covariates on *p* parameters can be given by $(2^n)^p$: where a simple linear regression may have up to 64 possible combinations of 6 covariates, a 4-parameter dynamic occupancy model would have 16 million combinations of these same covariates. This explosion of candidate models generally precludes exhaustive comparisons of possible models and requires some reduction of the models tested. Models in our sample include both Frequentist (n = 76) and Bayesian (n = 24) frameworks, which differ considerably in their manner of implementation; some articles in our sample included multiple distinct modelling workflows, resulting in a higher total number of models than articles. A summary of modelling practices in DOMs is given in @tbl-modelling.

```{r Modelling summary table}
#| echo: false
#| message: false
#| label: tbl-modelling
#| tbl-cap: "Modelling practices in dynamic occupancy models, subset by frequentist or bayesian implementations. The median covariate count presented here represents the median quantity of covariates considered for each model parameter across the studies in our review. The model selection methods represented in this table are non-exclusive and some articles employ multiple approaches. 2 models included in the 'Overall' column are neural network based and fall into neither the Frequentist or Bayesian categories."
 
modellingSummary <- read_csv("Figures/ModellingSummary.csv")

modellingSummary |>
  mutate(Variable = fct(Variable, 
                        levels = c("Number", "MedianCovs", 
                                   "Prop_AnySelect", "Prop_Candidate",
                                   "Prop_Sequential", "Prop_Simple",
                                   "Prop_ModAvg", "Prop_GOF", 
                                   "Prop_Eval"))) |>
  arrange(Variable) |>
  mutate(Variable = as.character(Variable)) |>
  gt(rowname_col = "Variable") |> 
  tab_row_group(
    label = "Covariate selection methods",
    rows = c("Prop_AnySelect", "Prop_Candidate",
             "Prop_Sequential", "Prop_Simple", "Prop_ModAvg"),
    id = "select"
  ) |>
  tab_row_group(
    label = "Model evaluation conducted",
    rows = c("Prop_GOF", "Prop_Eval"),
    id = "eval"
  ) |>
  row_group_order(groups = c(NA, "select", "eval")) |>
  text_case_match("Number" ~ "Number of studies",
                  "MedianCovs" ~ "Median covariates considered per parameter",
                  "Prop_ModAvg" ~ "Percentage using model-averaging",
                  "Prop_AnySelect" ~ "Percentage using any model selection approach",
                  "Prop_Sequential" ~ "Percentage using procedural model selection",
                  "Prop_Simple" ~ "Percentage selecting covariates with simpler models",
                  "Prop_Candidate" ~ "Percentage comparing models in a candidate set",
                  "Prop_GOF" ~ "Percentage calculating goodness-of-fit",
                  "Prop_Eval" ~ "Percentage assessing predictive performance",
                  .locations = cells_stub()) |>
  fmt_percent(rows = 3:9, decimals = 0) |>
  fmt_integer(rows = 1) |>
  tab_stub_indent(
    rows = 3:9,
    indent = 3
  ) |>
  tab_style(
    locations = cells_row_groups(),
    style = cell_text(style = "italic")
  ) |>
  tab_style(
    locations = cells_column_labels(),
    style = list(cell_fill(color = "aquamarine4"),
                 cell_text(color = "white"))
  ) |>
  tab_style(
    locations = cells_body(columns = "All models"),
    style = cell_text(style = "italic")
  ) 
#|>
 # as_raw_html()
```

The largest differences between the frequentist and Bayesian models in our sample lie in their approaches to model selection. Where 95% of frequentist models perform some manner of model selection to determine covariate inclusions for their models, only 33% of Bayesian models do so, with the majority instead fitting a single model defined *a priori*. Methods used for model selection vary considerably both within and between the two modelling frameworks (@tbl-modelling). For frequentist models, the most popular and conventional approach to model selection (45% of models) involves the creation of a fully pre-defined model set containing some number of hypothesis candidate models, where the best model is selected according to the lowest AIC score. The next most popular method in frequentist studies is to use procedural model selection methods (37% of models), where the structure for each model parameter is fit in sequence. For example, this protocol might first identify the best structure for detection probability while holding the other parameters constant, before moving on to initial occupancy and so on until all parameters are fixed. The remainder of frequentist studies (8%) use a variety of approaches, such as fitting simpler models like single season occupancy models to identify the most informative terms to use in a DOM. Across all frequentist implementations, 47% of articles summarise a final subset of models using multi-model inference and model-averaging with AIC weights [@burnham2004].

Those Bayesian models which *do* perform model selection take various approaches, with largely idiosyncratic methods across these studies. While direct comparison of model fit is rare in Bayesian methods, it is feasible — @urban2023 identifies the best model from a Bayesian candidate set using the predictive performance on both in and out-of-sample validation data. Another approach used by @cook2022 fit a global model including all covariates before removing each covariate where the 95% credible interval of the posterior distribution overlapped zero and refitting the model. @ahumada2013 takes a hybrid approach, in which model selection is conducted by a procedural method in the frequentist framework before refitting the best structure as a Bayesian model.

Limited research has been conducted on the advantages of different methods for covariate selection in DOMs, and there is unlikely to be a one-size-fits-all approach which will be appropriate for all possible use-cases. However, it is important to consider the implications of the different model selection approaches in common usage, and research from the SDM literature highlights how covariate selection can influence our interpretation of model outputs [@brodie2020]. Within the occupancy modelling literature, @stewart2023's article on covariate selection in single-season occupancy models discusses important attributes of the information-criteria approaches widely used in frequentist models in our review, noting that these approaches can lead to inaccurate coefficient estimates that may influence model inference. @morin2020's work raises other concerns on procedural model selection methods, demonstrating how the fine details of modelling protocols can determine whether the best-fitting possible model is identified and which covariates appear in final models. The literature on performance of Bayesian model selection methods is more sparse, although @hooten2015's guide to Bayesian model selection in ecology is a valuable resource for possible methods of fitting those models.

Regardless of covariate selection protocol, 'the selection of a best model does not guarantee the selection of a good model' [@mackenzie2004]. Assessment of the performance of DOMs generally requires additional steps, and the best ways to achieve this are not yet clear. There is no broadly-accepted goodness-of-fit test for dynamic occupancy models, although @mackenzie2004's approach for single-season occupancy models using a parametric bootstrap which can been extended to DOMs; this test is implemented in the *AICcModAvg* and *unmarked* R packages. @kéry2021 describe the test and present an alternative based on separately assessing fit to static and dynamic components of the model. In Bayesian implementations, posterior predictive checks offer means to assess model fit [@gelman2014]. @broms2016 discusses further possibilities for model evaluation in the Bayesian context focusing on single-season multi-species occupancy models, and extensions of their approach may also be applicable to the DOM. As with other hierarchical models, model evaluation for DOMs can be difficult and somewhat uncertain compared to other model types, as the primary response variable of interest (species occupancy) is a latent variable where the true state is generally not known. Predictive performance evaluation is thus typically based on *observed* occupancy data, where a DOM is used to simulate detection histories to be compared with field survey results.

Perhaps as a result of these difficulties, assessment of model fit and model performance was rare amongst the articles in our sample. Only 18% of studies tested for goodness-of-fit, and just 7% calculated predictive performance. These rates are considerably lower than those reported for SDMs; for which closer to 50% of articles were found to test both fit and performances [@araújo2019].

# Modelling objectives

Studies in our sample were classified according to their objectives as stated by authors to explore the use-cases which the DOM has been applied to (@fig-objectives). These objective categories are non-exclusive, with many studies falling into multiple categories. Across the study period the DOM has been frequently employed to estimate trends in species occupancy, to explore relationships between environmental factors and occupancy, and, increasingly often, to make predictions of occupancy spatially to unsurveyed locations or temporally to hypothetical future conditions. Within each of these broad categories lies even more variation in objectives, emphasising the DOM's flexibility as a tool for making ecological inference in diverse contexts.

36% of articles used the DOM to monitor trends in occupancy state through time ("Estimate trends" in @fig-objectives A), both for single species of high conservation interest and for broader community assemblages of species [@ahumada2013; @scott2015]. These studies offer valuable insights on the state of species across landscapes and through time, demonstrating the DOM's suitability for monitoring oriented projects; including those where multiple species need to be assessed at once. Other articles were more focused on examining the factors which influence species occupancy, either testing pre-specified hypothetical relationships (44% of articles) or taking a broader tack to identify drivers of occupancy without preconception (35%). The distinction between the two is important, as it guides which covariates may be considered and how model selection may be used to fit models. Many of these studies target core conservation priorities for their focal species, like @olson2005's early DOM assessing the influence of barred owls on threatened spotted owl. Explorations of these pivotal relationships are important for guiding management action, and may also be used to test the effectiveness of these actions [@miller2023]. In scenarios where less is known about species habitat preference, DOMs may be used to examine the influence of a wider variety of factors as in @huber2017's study testing the relative influence of dozens of habitat covariates on Wood warbler occupancy. In recent years, increasing numbers of articles have used DOMs to generate predictions of species occupancy; this a use-case for which DOMs show considerable promise [@kéry2013; @briscoe2021]. These predictions often have strong utility for conservation management. For example, @mcgowan2020 projects future occupancy for wetland birds under alternative management scenarios, and @pollentier2021 generates distribution maps resembling those made with SDMs.

![A) Proportion of articles in each year-strata and across all years which match each of six non-exclusive objective categories. B) Quantity of covariates considered per parameter for models which pursued each objectives.](Figures/ObjectiveFigure.jpeg){#fig-objectives}

Study objectives strongly inform approaches to model building, particularly with respect to covariate selection. @fig-objectives B presents the quantity of covariates considered for models applied to each of our objective categories, with apparent differences between objectives. Not unexpectedly, articles which focused on describing new methods for DOMs had fewer covariates than those studies focused on more applied objectives. However, differences persist between those articles observing trends, identifying trends in occupancy, testing relationships, and making predictions.

# Synthesis and key priorities

Approaches to building any type of model will necessarily depend on the possibilities of the data at hand and on the priorities of the model-builder. This precludes any prescription of the 'best' way to build a model, however, there are still important discussions to be had on decisions made in the modelling process. One aspect of fitting DOMs meriting broader discussion centres on 'model complexity,' and how much must be incorporated into models to reliably model species occupancy under different contexts and use cases. Complexity is a broad term encompassing many aspects of a model [@merow2014], and opinions on simplicity versus complexity in ecological models are diverse. Where some advocate for the simplest possible models, arguing that they are most generalisable; others insist that overly-simple models cannot adequately represent the most important drivers in a system [@evans2013; @lonergan2014]. By their nature the DOM is somewhat more complex than simpler models for studying occupancy due to their hierarchical structure, which is necessary to control for detectability and to capture occupancy dynamics. Within this structure, however, further complexity is to some degree up to the modeller: one can choose how many covariates to consider for inclusion on the various parameters, and how to represent the nature of the relationship between those covariates and parameters. Research from SDMs indicates that allowing for more complex relationships can improve model performance in predicting occupancy [@valavi2023], an increasingly popular use-case for the DOM. Within the DOM framework, there are promising developments on that front: @joseph2020 presents a novel neural-network occupancy model which allows for exponentially higher levels of complexity and may offer improved performance for prediction-oriented studies.

Covariate selection seems to be a particularly important area for further investigations into building DOMs. In our review, we see little consensus around which approaches are most applicable for any given use case, and existing work on covariate selection in DOMs raises concerns on whether common methods always produce the most suitable models [@morin2020; @stewart2023]. This is true for both frequentist and Bayesian implementations, and comparative research on covariate selection under both frameworks may help to inform model users on which method is most appropriate for their use-cases. In a similar vein, the low number of articles in our review that conducted model evaluation or assessed model fit raises different questions. While the appropriate method of model evaluation may depend on data availability and research objectives, assessing models by some method is generally important to understand how reliable model outputs may be [@araújo2005; @guisan2005]. Existing uncertainties around whether current methods are suitable for the task likely discourage users from calculating these metrics, and further research is needed to establish trusted practices for assessing the quality of DOMs.

These priorities are particularly important given the frequent applied objectives of DOM users, tackling challenges which include assessing critically endangered species, guiding public health management of disease vectors, and tracking rapidly developing biological invasions [@carvalho2023; @moreira2016; @wood2020]. The DOM is well suited to these situations, and it is to be expected that as these types of applications are more commonly attempted understanding the sensitivity of model outputs to decisions made in the model fitting process becomes increasingly important. In the two decades since the publication of @mackenzie2003 the dynamic occupancy model has become a widely used tool for ecological inference, with numerous extensions to the modelling framework further broadening the scope of questions and use-cases for which it may be applied. Given their increasing popularity, further research and guidelines around issues of model building may help to make the DOM more accessible to newcomers and support confidence in model interpretation. Parallels to existing work in the SDM literature on guidelines for reporting and modelling standards could be valuable contributions in achieving these aims and provide useful examples in developing methods and guidelines specifically focused on DOMs [@zurell2020; @araújo2019].
